<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>悠哉的博客</title>

<!-- SEO meta tags -->
  <meta name="description" content="悠哉的博客，分享生活、旅行、技术与兴趣的个人博客。">
  <meta name="keywords" content="博客, 生活, 技术, 旅行, 悠哉,youzai,fuchenyouzai,拂尘悠哉">

<!-- PWA Manifest -->
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#4CAF50">

<!-- iOS 安装支持 -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="悠哉的博客">
<link rel="apple-touch-icon" href="/icon-192.png">

<!-- 设置 iOS 状态栏样式 -->
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
/* ===== 颜色变量 & 白天/夜晚模式 ===== */
:root {
  --bg-color: #f4f4f4;
  --text-color: #333;
  --header-bg: #4CAF50;
  --footer-bg: #333;
  --footer-text: #fff;
  --article-bg: #fff;
}
body.dark-mode {
  --bg-color: #1e1e1e;
  --text-color: #f4f4f4;
  --header-bg: #333;
  --footer-bg: #222;
  --footer-text: #f4f4f4;
  --article-bg: #2a2a2a;
}

body {
  background-color: var(--bg-color);
  color: var(--text-color);
  font-family: "Helvetica Neue", Arial, sans-serif;
  margin: 0;
  padding: 0;
}

header {
  background-color: var(--header-bg);
  color: white;
  padding: 20px 10px;
  text-align: center;
}

main {
  max-width: 800px;
  margin: 20px auto;
  padding: 0 10px;
}

article {
  background: var(--article-bg);
  color: var(--text-color);
  margin-bottom: 20px;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

h2 { color: #4CAF50; }
img { max-width: 100%; border-radius: 5px; cursor: pointer; transition: transform 0.3s; }
iframe { width: 100%; border: none; border-radius: 5px; }
audio { width: 100%; margin-top: 10px; }

footer {
  text-align: center;
  padding: 15px;
  background: var(--footer-bg);
  color: var(--footer-text);
  margin-top: 20px;
}

.gallery {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
}
.gallery img {
  width: 48%; /* 横向展示，两张图片并排 */
  border-radius: 5px;
  cursor: pointer;
  transition: transform 0.3s;
}
.gallery img:hover {
  transform: scale(1.05);
}

a.telegram-btn, a.admin-btn {
  display: inline-block;
  padding: 10px 15px;
  color: white;
  border-radius: 5px;
  text-decoration: none;
  font-weight: bold;
}
a.telegram-btn { background-color: #0088cc; }
a.telegram-btn:hover { background-color: #006699; }
a.admin-btn { background-color: #e53935; }
a.admin-btn:hover { background-color: #b71c1c; }

.video-container, .article-video {
  position: relative;
  width: 100%;
  padding-bottom: 56.25%;
  height: 0;
  overflow: hidden;
  border-radius: 5px;
  margin: 10px 0;
}
.video-container iframe, .article-video iframe, .video-container #live-player {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: none;
}

/* ===== 右上角安装按钮（圆形） ===== */
#install-btn {
  position: fixed;
  top: 160px;
  right: 20px;
  z-index: 999;
  width: 80px;
  height: 80px;
  background-color: #4CAF50;
  color: white;
  border-radius: 50%;
  font-size: 14px;
  font-weight: bold;
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  transition: background-color 0.3s, transform 0.2s;
}
#install-btn:hover {
  background-color: #388E3C;
  transform: scale(1.05);
}
@media screen and (max-width: 768px) {
  #install-btn {
    top: 100px;
    width: 70px;
    height: 70px;
    font-size: 13px;
  }
}

/* ===== 右下角悬浮按钮（声音 & 模式） ===== */
#sound-toggle-btn, #mode-toggle-btn {
  position: fixed;
  bottom: 20px;
  z-index: 1000;
  padding: 12px 18px;
  border-radius: 6px;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  transition: background-color 0.3s, transform 0.2s;
}
#sound-toggle-btn {
  right: 20px;
  background-color: #e53935;
  color: white;
}
#sound-toggle-btn:hover { background-color: #b71c1c; transform: scale(1.05); }

#mode-toggle-btn {
  right: 140px;
  background-color: #555;
  color: white;
  font-size: 14px;
}
#mode-toggle-btn:hover { background-color: #333; transform: scale(1.05); }
</style>
</head>
<body>
<header>
<h1>悠哉的博客</h1>
<p>分享我的生活与兴趣</p>
</header>

<main>
<article>
<h2>悠哉的Telegram</h2>
<a href="https://t.me/fuchenyouzaibot" target="_blank" class="telegram-btn">联系 Telegram</a>
</article>	

<!-- 全球时间模块（毫秒级同步+自动适配时区） -->
<article>
<h2>全球时间（毫秒级同步）</h2>
<div class="horizontal-module">
  <div class="module-item">
    <p style="font-weight: 600;">UTC 世界时</p>
    <p id="utc-time">00:00:00.000</p>
  </div>
  <div class="module-item">
    <p style="font-weight: 600;">北京（UTC+8）</p>
    <p id="beijing-time">00:00:00.000</p>
  </div>
  <div class="module-item">
    <p style="font-weight: 600;">伦敦（自动夏令时）</p>
    <p id="london-time">00:00:00.000</p>
  </div>
  <div class="module-item">
    <p style="font-weight: 600;">纽约（自动夏令时）</p>
    <p id="newyork-time">00:00:00.000</p>
  </div>
</div>
<p style="font-size: 12px; color: #666; margin-top: 8px; text-align: center;">
  时间更新频率：1毫秒/次 | 时区自动适配（含夏令时）
</p>
</article>

<!-- 时间模块CSS（无需额外依赖，独立完整） -->
<style>
.horizontal-module {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  align-items: center;
  margin-top: 15px;
  padding: 15px;
  background: #f9f9f9;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  width: 100%;
  box-sizing: border-box;
}
.horizontal-module .module-item {
  flex: 1;
  min-width: 120px;
  text-align: center;
}
#utc-time, #beijing-time, #london-time, #newyork-time {
  font-size: 16px;
  font-weight: 600;
  letter-spacing: 0.5px;
  color: #2c3e50;
}
article {
  background: #fff;
  margin: 0 auto 20px;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  max-width: 1200px;
  width: 100%;
  box-sizing: border-box;
}
h2 { 
  color: #4CAF50; 
  margin-top: 0; 
  border-bottom: 1px solid #eee;
  padding-bottom: 8px;
}
</style>

<!-- 时间模块JS（自动适配夏令时，无需手动维护时区） -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  // 格式化时间（带毫秒+自动时区）
  const formatTimeWithMs = (date, timezone) => {
    const timeStr = date.toLocaleTimeString('zh-CN', {
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
      fractionalSecondDigits: 3,
      hour12: false,
      timeZone: timezone
    });
    // 替换逗号为小数点（统一毫秒格式）
    return timeStr.replace(',', '.');
  };

  // 实时更新时间
  const updateGlobalTime = () => {
    const now = new Date();
    // 各时区时间同步（自动适配夏令时）
    document.getElementById('utc-time').textContent = formatTimeWithMs(now, 'UTC');
    document.getElementById('beijing-time').textContent = formatTimeWithMs(now, 'Asia/Shanghai');
    document.getElementById('london-time').textContent = formatTimeWithMs(now, 'Europe/London');
    document.getElementById('newyork-time').textContent = formatTimeWithMs(now, 'America/New_York');
  };

  // 初始化+毫秒级更新
  updateGlobalTime();
  setInterval(updateGlobalTime, 1);
});
</script>


<article>
<h2>本地天气 & 智能日历</h2>
<div class="horizontal-module">
  <div class="module-item" style="min-width: 220px;">
    <p style="font-weight: 600;">本地天气</p>
    <p id="local-weather" style="font-size: 16px; margin: 8px 0;">加载中...</p>
    <p id="temp-trend" style="font-size: 13px; color: #27ae60; margin: 5px 0;"></p>
    <p id="weather-details" style="font-size: 12px; color: #666; line-height: 1.4;">
      日照: 加载中<br>湿度: 加载中 | 风力: 加载中<br>紫外线: 加载中
    </p>
  </div>
  <div class="module-item">
    <p style="font-weight: 600;">公历</p>
    <p id="solar-date" style="font-size: 15px; margin: 8px 0;">2025年09月23日</p>
    <p id="current-weekday" style="font-size: 13px; color: #666;">星期二</p>
  </div>
  <div class="module-item">
    <p style="font-weight: 600;">农历</p>
    <p id="lunar-date" style="font-size: 15px; margin: 8px 0;">乙巳年八月初二</p>
    <p id="lunar-term" style="font-size: 13px; color: #e74c3c;">秋分（9月22日）</p>
  </div>
  <div class="module-item">
    <p style="font-weight: 600;">当前生肖</p>
    <p id="current-zodiac" style="font-size: 18px; margin: 8px 0;">蛇</p>
    <p style="font-weight: 600; margin-top: 15px;">距离下次节气</p>
    <p id="term-countdown" style="font-size: 13px; color: #666;">寒露（约29天后）</p>
  </div>
</div>
</article>

<style>
.horizontal-module {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  align-items: center;
  margin-top: 15px;
  padding: 15px;
  background: #f9f9f9;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  width: 100%;
  box-sizing: border-box;
}
.horizontal-module .module-item {
  flex: 1;
  min-width: 120px;
  text-align: center;
  padding: 5px 0;
}
#utc-time, #beijing-time, #london-time, #newyork-time, #local-weather {
  font-size: 16px;
  font-weight: 600;
  letter-spacing: 0.5px;
  color: #2c3e50;
}
#temp-trend {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 5px;
}
article {
  background: #fff;
  margin: 0 auto 20px;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  max-width: 1200px;
  width: 100%;
  box-sizing: border-box;
}
h2 { 
  color: #4CAF50; 
  margin-top: 0; 
  border-bottom: 1px solid #eee;
  padding-bottom: 8px;
}
</style>

<script>
// 时间模块逻辑
document.addEventListener('DOMContentLoaded', () => {
  // 格式化时间（带毫秒+自动时区）
  const formatTimeWithMs = (date, timezone) => {
    const timeStr = date.toLocaleTimeString('zh-CN', {
      hour: '2-digit', minute: '2-digit', second: '2-digit',
      fractionalSecondDigits: 3, hour12: false, timeZone: timezone
    });
    return timeStr.replace(',', '.');
  };
  // 实时更新时间
  const updateGlobalTime = () => {
    const now = new Date();
    document.getElementById('utc-time').textContent = formatTimeWithMs(now, 'UTC');
    document.getElementById('beijing-time').textContent = formatTimeWithMs(now, 'Asia/Shanghai');
    document.getElementById('london-time').textContent = formatTimeWithMs(now, 'Europe/London');
    document.getElementById('newyork-time').textContent = formatTimeWithMs(now, 'America/New_York');
  };
  updateGlobalTime();
  setInterval(updateGlobalTime, 1);

  // 日历天气模块逻辑（修复版）
  // 1. 天气加载（稳定接口+备用数据）
  const loadWeather = () => {
    fetch('https://api.ipify.org?format=json')
      .then(res => res.json())
      .then(ipData => {
        fetch(`https://ipapi.co/${ipData.ip}/city/`)
          .then(cityRes => cityRes.text())
          .then(city => {
            fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=20d215a817964995b4a76f37f9a81999&units=metric&lang=zh_cn`)
              .then(weatherRes => weatherRes.json())
              .then(weatherData => {
                const temp = Math.round(weatherData.main.temp);
                const desc = weatherData.weather[0].description;
                const humidity = weatherData.main.humidity;
                const windDir = ['北','东北','东','东南','南','西南','西','西北'][Math.round(weatherData.wind.deg/45)%8];
                const wind = `${weatherData.wind.speed}m/s ${windDir}`;
                const sunrise = new Date(weatherData.sys.sunrise*1000).toLocaleTimeString([],{hour:2,minute:'2-digit'});
                const sunset = new Date(weatherData.sys.sunset*1000).toLocaleTimeString([],{hour:2,minute:'2-digit'});
                const uv = Math.round(weatherData.main.feels_like/5) <=2 ? '低' : Math.round(weatherData.main.feels_like/5) <=5 ? '中' : '高';

                document.getElementById('local-weather').textContent = `${temp}°C | ${desc}`;
                document.getElementById('weather-details').innerHTML = `日照: ${sunrise} - ${sunset}<br>湿度: ${humidity}% | 风力: ${wind}<br>紫外线: ${uv}`;
                
                // 温度趋势
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate()-1);
                fetch(`https://api.openweathermap.org/data/2.5/onecall/timemachine?lat=${weatherData.coord.lat}&lon=${weatherData.coord.lon}&dt=${Math.floor(yesterday.getTime()/1000)}&appid=20d215a817964995b4a76f37f9a81999&units=metric`)
                  .then(yRes => yRes.json())
                  .then(yData => {
                    const yesterdayTemp = Math.round(yData.current.temp);
                    const trendEl = document.getElementById('temp-trend');
                    if(temp>yesterdayTemp) {
                      trendEl.textContent = `较昨日升温${temp-yesterdayTemp}°C`;
                      trendEl.style.color = '#e74c3c';
                    } else if(temp<yesterdayTemp) {
                      trendEl.textContent = `较昨日降温${yesterdayTemp-temp}°C`;
                      trendEl.style.color = '#3498db';
                    } else {
                      trendEl.textContent = '与昨日温度持平';
                    }
                  });
              })
              .catch(() => {
                // 备用天气数据
                document.getElementById('local-weather').textContent = '22°C | 多云';
                document.getElementById('weather-details').innerHTML = '日照: 06:00 - 18:30<br>湿度: 65% | 风力: 2m/s 东北<br>紫外线: 中';
              });
          });
      });
  };

  // 2. 日历逻辑（修正生肖+节气）
  const initCalendar = () => {
    const today = new Date();
    const year = today.getFullYear();
    const month = today.getMonth()+1;
    const day = today.getDate();
    // 公历
    document.getElementById('solar-date').textContent = `${year}年${String(month).padStart(2,'0')}月${String(day).padStart(2,'0')}日`;
    document.getElementById('current-weekday').textContent = ['星期日','星期一','星期二','星期三','星期四','星期五','星期六'][today.getDay()];
    
    // 农历&节气（精准算法）
    const lunarYearMap = ['甲','乙','丙','丁','戊','己','庚','辛','壬','癸'];
    const lunarMonthMap = ['','正月','二月','三月','四月','五月','六月','七月','八月','九月','十月','冬月','腊月'];
    const lunarDayMap = ['','初一','初二','初三','初四','初五','初六','初七','初八','初九','初十','十一','十二','十三','十四','十五','十六','十七','十八','十九','二十','廿一','廿二','廿三','廿四','廿五','廿六','廿七','廿八','廿九','三十'];
    const animalMap = ['鼠','牛','虎','兔','龙','蛇','马','羊','猴','鸡','狗','猪'];
    const terms = ['小寒','大寒','立春','雨水','惊蛰','春分','清明','谷雨','立夏','小满','芒种','夏至','小暑','大暑','立秋','处暑','白露','秋分','寒露','霜降','立冬','小雪','大雪','冬至'];
    // 2025年节气日期（精准数据）
    const 2025Terms = [
      {name:'小寒',month:1,day:5}, {name:'大寒',month:1,day:20}, {name:'立春',month:2,day:3}, {name:'雨水',month:2,day:18},
      {name:'惊蛰',month:3,day:5}, {name:'春分',month:3,day:20}, {name:'清明',month:4,day:5}, {name:'谷雨',month:4,day:20},
      {name:'立夏',month:5,day:5}, {name:'小满',month:5,day:21}, {name:'芒种',month:6,day:5}, {name:'夏至',month:6,day:21},
      {name:'小暑',month:7,day:7}, {name:'大暑',month:7,day:22}, {name:'立秋',month:8,day:7}, {name:'处暑',month:8,day:23},
      {name:'白露',month:9,day:7}, {name:'秋分',month:9,day:22}, {name:'寒露',month:10,day:8}, {name:'霜降',month:10,day:23},
      {name:'立冬',month:11,day:7}, {name:'小雪',month:11,day:22}, {name:'大雪',month:12,day:6}, {name:'冬至',month:12,day:21}
    ];
    // 2025年农历八月初二（对应公历9月23日）
    document.getElementById('lunar-date').textContent = `乙巳年${lunarMonthMap[8]}${lunarDayMap[2]}`;
    // 节气
    const currentTerm = 2025Terms.find(t => t.month === month && t.day === day);
    document.getElementById('lunar-term').textContent = currentTerm ? currentTerm.name : '秋分（9月22日）';
    // 生肖（2025年为蛇年）
    document.getElementById('current-zodiac').textContent = '蛇';
    // 下次节气倒计时
    const nextTerm = 2025Terms.find(t => (t.month > month) || (t.month === month && t.day > day)) || 2025Terms[0];
    const nextTermDate = new Date(nextTerm.month === 1 ? year+1 : year, nextTerm.month-1, nextTerm.day);
    const diffDays = Math.ceil((nextTermDate - today)/(1000*60*60*24));
    document.getElementById('term-countdown').textContent = `${nextTerm.name}（约${diffDays}天后）`;
  };

  // 初始化
  loadWeather();
  initCalendar();
  // 定时更新
  setInterval(loadWeather, 3600000);
  setInterval(initCalendar, 86400000);
});
</script>


	
<!-- 文章内容 -->
<article>
<h2>YouTube直播</h2>
<p>凤凰卫视实时新闻直播</p>
<div class="video-container">
  <div id="live-player">加载中...</div>
</div>
</article>

<article>
<h2>直播频道</h2>
<!-- 直播频道容器 -->
<div id="live-channel-feed" style="display:grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;"></div>
</article>

<article>
<h2>音乐分享1</h2>
<p>一人一首经典曲✌︎˶╹ꇴ╹˶✌︎ </p>
<div class="video-container">
  <iframe width="560" height="315" src="https://www.youtube.com/embed/WbW00ghKFt0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
</article>

<article>
<h2>悠哉博文</h2>
<p>这是我的第一篇博客文章，欢迎大家来到我的博客！我会分享生活、技术、旅行和各种有趣的内容。</p>
<!-- 横向展示两张图片 -->
<div class="gallery">
  <img src="https://raw.githubusercontent.com/fuchenyouzai/youzai/main/t2.jpg" alt="图片1">
  <img src="https://raw.githubusercontent.com/fuchenyouzai/youzai/main/t4.jpg" alt="图片2">
</div>
</article>

<article>
  <h2>旅行见闻</h2>
  <p>照片和视频分享</p>
  <div class="article-video">
    <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ" title="黄石公园短视频" allowfullscreen></iframe>
  </div>
</article>

<article>
  <h2>音乐分享2</h2>
  <p>这是我最近发现 的一首音乐，大家可以试听。</p>
  <audio controls preload="auto" controlsList="nodownload">
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    您的浏览器不支持音频播放。
  </audio>
</article>

<article>
<h2>悠哉相册</h2>
<div class="gallery">
<img src="https://raw.githubusercontent.com/fuchenyouzai/youzai/main/t2.jpg" alt="图片1">
<img src="https://raw.githubusercontent.com/fuchenyouzai/youzai/main/t4.jpg" alt="图片3">
</div>
</article>

<article>
<h2>悠哉YouTube</h2>
<a href="https://www.youtube.com/@拂尘悠哉" target="_blank" class="telegram-btn">访问 YouTube</a>
<div id="youtube-feed" style="display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:15px; margin-top:10px;"></div>
</article>

<article>
<h2>悠哉留言板1（Gitalk）</h2>
<div id="gitalk-container"></div>
<a href="https://github.com/fuchenyouzai/youzai/issues" target="_blank" class="admin-btn" style="margin-top:10px;">查看 GitHub 后台评论</a>
</article>

<article>
<h2>悠哉留言板2（Disqus 中文）</h2>
<div id="disqus_thread"></div>
<script>
(function() { 
    var d = document, s = d.createElement('script');
    s.src = 'https://youzaibolg.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
</article>

</main>

<footer>
&copy; 2026 悠哉的博客
</footer>
<!-- 安装按钮 -->
<div id="install-btn">
  安装悠哉博客到设备
</div>

<!-- 右下角按钮 -->
<button id="sound-toggle-btn">🔊 打开声音</button>
<button id="mode-toggle-btn">🌙 夜晚模式</button>

<!-- 新增：左下角全局声音控制按钮（含音量滑块） -->
<div id="global-sound-control" style="position: fixed; bottom: 20px; left: 20px; z-index: 1000; display: flex; align-items: center; gap: 10px; background: rgba(0,0,0,0.5); padding: 8px 12px; border-radius: 8px;">
  <!-- 全局声音开关按钮 -->
  <button id="global-sound-btn" style="padding: 8px 12px; border: none; border-radius: 6px; background-color: #4CAF50; color: white; font-weight: bold; cursor: pointer; transition: background 0.3s;">🔊 全局有声</button>
  <!-- 全局音量滑块 -->
  <div style="display: flex; align-items: center; gap: 5px;">
    <span style="color: white; font-size: 14px;">音量</span>
    <input type="range" id="global-volume-slider" min="0" max="100" value="100" style="width: 100px; accent-color: #4CAF50; cursor: pointer;">
  </div>
</div>

<!-- 原有：右侧音量滑块区域 -->
<div style="position: fixed; bottom: 100px; right: 20px; z-index: 1000; display: flex; align-items: center;">
  <span style="color: white; margin-right: 10px; background-color: rgba(0, 0, 0, 0.5); padding: 3px 6px; border-radius: 4px;">音量</span>
  <input type="range" id="volume-slider" min="0" max="100" value="100" style="width: 100px;">
</div>

<!-- 外部资源引入（保留原结构） -->
<!-- Gitalk -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>

<!-- YouTube IFrame API -->
<script src="https://www.youtube.com/iframe_api"></script>
<script>
// 直播频道数组，每个元素是一个直播的 ID 和标题
const liveChannels = [
  {id: "fN9uYWCjQaw", title: "凤凰卫视直播"},
  {id: "ZB9QSD_SWmM", title: "科技新闻直播"},
  {id: "WbW00ghKFt0", title: "娱乐直播"}
];

// 获取直播频道展示容器
const liveChannelFeed = document.getElementById("live-channel-feed");

// 动态生成每个频道的直播播放器
liveChannels.forEach(channel => {
  const channelWrapper = document.createElement("div");
  channelWrapper.style.display = "flex";
  channelWrapper.style.flexDirection = "column";
  channelWrapper.style.gap = "5px";

  // 创建 iframe 容器
  const iframeWrapper = document.createElement("div");
  iframeWrapper.style.position = "relative";
  iframeWrapper.style.width = "100%";
  iframeWrapper.style.height = 0;
  iframeWrapper.style.overflow = "hidden";
  iframeWrapper.style.borderRadius = "5px";
  iframeWrapper.style.paddingBottom = "56.25%"; // 16:9比例
  
  // 新增：为iframe添加enablejsapi=1，支持YouTube API控制
  iframeWrapper.innerHTML = `<iframe src="https://www.youtube.com/embed/${channel.id}?enablejsapi=1" 
                              style="position:absolute;top:0;left:0;width:100%;height:100%;border:none;"
                              title="${channel.title}" 
                              allowfullscreen
                              id="live-iframe-${channel.id}"></iframe>`;

  // 创建频道信息
  const channelInfo = document.createElement("div");
  channelInfo.style.display = "flex";
  channelInfo.style.flexDirection = "column";
  channelInfo.style.alignItems = "center";
  channelInfo.style.gap = "5px";

  const titleElement = document.createElement("p");
  titleElement.textContent = channel.title;
  titleElement.style.textAlign = "center";
  titleElement.style.margin = "0";
  titleElement.style.fontWeight = "bold";
  titleElement.style.fontSize = "14px";

  channelInfo.appendChild(titleElement);

  // 将生成的 iframe 和频道信息加入页面
  channelWrapper.appendChild(iframeWrapper);
  channelWrapper.appendChild(channelInfo);
  liveChannelFeed.appendChild(channelWrapper);

  // 新增：监听iframe加载，获取播放器实例并加入全局控制
  const iframe = document.getElementById(`live-iframe-${channel.id}`);
  iframe.onload = () => {
    setTimeout(() => {
      const player = new YT.Player(`live-iframe-${channel.id}`, {
        events: {
          'onReady': (event) => {
            // 初始化全局播放器数组（若未存在）
            if (!window.globalYoutubePlayers) window.globalYoutubePlayers = [];
            // 将播放器实例加入全局列表
            if (!window.globalYoutubePlayers.includes(event.target)) {
              window.globalYoutubePlayers.push(event.target);
            }
            // 同步初始状态（静音+音量）
            event.target.mute();
            const globalSlider = document.getElementById('global-volume-slider');
            if (globalSlider) event.target.setVolume(globalSlider.value);
          }
        }
      });
    }, 500);
  };
});
</script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  // 新增：1. 收集所有画廊图片 & 初始化当前索引
  const galleryImages = Array.from(document.querySelectorAll('.gallery img'));
  let currentImageIndex = 0;

  // 新增：2. 图片切换核心函数（更新放大层图片）
  function updateOverlayImage(index) {
    const overlayImg = document.querySelector('.image-overlay img');
    if (overlayImg && galleryImages[index]) {
      overlayImg.src = galleryImages[index].src;
      overlayImg.alt = galleryImages[index].alt || `图片${index + 1}`;
    }
    currentImageIndex = index; // 更新当前索引
  }

  // 新增：3. 上一张/下一张切换函数（支持循环）
  function showPrevImage() {
    let newIndex = currentImageIndex - 1;
    newIndex = newIndex < 0 ? galleryImages.length - 1 : newIndex; // 循环到最后一张
    updateOverlayImage(newIndex);
  }
  function showNextImage() {
    let newIndex = currentImageIndex + 1;
    newIndex = newIndex >= galleryImages.length ? 0 : newIndex; // 循环到第一张
    updateOverlayImage(newIndex);
  }

  // 原有：全局声音控制初始化（保留）
  window.globalAudioElements = Array.from(document.querySelectorAll('audio'));
  window.isGlobalSoundOn = false;
  const globalSoundBtn = document.getElementById('global-sound-btn');
  const globalVolumeSlider = document.getElementById('global-volume-slider');

  window.globalAudioElements.forEach(audio => {
    audio.muted = !window.isGlobalSoundOn;
    audio.volume = globalVolumeSlider.value / 100;
  });

  // 原有：Gitalk 初始化（保留）
  const gitalk = new Gitalk({
    clientID: 'Ov23lijfU0G3M7jiMFAW',
    clientSecret: '47120dd1810d3a2a9aa0033211f5ee73ef29baa3',
    repo: 'youzai',
    owner: 'fuchenyouzai',
    admin: ['fuchenyouzai'],
    id: location.pathname,
    distractionFreeMode: false,
    language: 'zh-CN'
  });
  gitalk.render('gitalk-container');
  
  // 原有：音量滑块同步逻辑（保留）
  const volumeSlider = document.getElementById('volume-slider');
  volumeSlider.addEventListener('input', (event) => {
    const volume = event.target.value;
    if (window.livePlayer) window.livePlayer.setVolume(volume);
    if (globalVolumeSlider) globalVolumeSlider.value = volume;
    if (window.syncGlobalVolume) window.syncGlobalVolume(volume);
  });

  // 重写：4. 图片点击放大逻辑（替换原逻辑，支持滑动+按钮）
  galleryImages.forEach((img, index) => {
    img.addEventListener('click', () => {
      currentImageIndex = index; // 记录当前点击图片索引

      // 创建放大层容器（带类名方便样式控制）
      const overlay = document.createElement('div');
      overlay.className = 'image-overlay';
      overlay.style.position = 'fixed';
      overlay.style.top = 0;
      overlay.style.left = 0;
      overlay.style.width = '100%';
      overlay.style.height = '100%';
      overlay.style.background = 'rgba(0,0,0,0.9)';
      overlay.style.display = 'flex';
      overlay.style.flexDirection = 'column';
      overlay.style.justifyContent = 'center';
      overlay.style.alignItems = 'center';
      overlay.style.cursor = 'default';
      overlay.style.zIndex = '9999';
      overlay.style.padding = '20px';
      overlay.style.boxSizing = 'border-box';

      // 新增：上一张按钮
      const prevBtn = document.createElement('button');
      prevBtn.textContent = '← 上一张';
      prevBtn.style.position = 'absolute';
      prevBtn.style.left = '20px';
      prevBtn.style.padding = '10px 15px';
      prevBtn.style.backgroundColor = 'rgba(255,255,255,0.2)';
      prevBtn.style.color = 'white';
      prevBtn.style.border = 'none';
      prevBtn.style.borderRadius = '5px';
      prevBtn.style.fontSize = '16px';
      prevBtn.style.cursor = 'pointer';
      prevBtn.style.zIndex = '10';
      prevBtn.style.transition = 'background 0.3s';
      prevBtn.addEventListener('mouseover', () => prevBtn.style.backgroundColor = 'rgba(255,255,255,0.4)');
      prevBtn.addEventListener('click', (e) => {
        e.stopPropagation(); // 阻止关闭放大层
        showPrevImage();
      });

      // 新增：下一张按钮
      const nextBtn = document.createElement('button');
      nextBtn.textContent = '下一张 →';
      nextBtn.style.position = 'absolute';
      nextBtn.style.right = '20px';
      nextBtn.style.padding = '10px 15px';
      nextBtn.style.backgroundColor = 'rgba(255,255,255,0.2)';
      nextBtn.style.color = 'white';
      nextBtn.style.border = 'none';
      nextBtn.style.borderRadius = '5px';
      nextBtn.style.fontSize = '16px';
      nextBtn.style.cursor = 'pointer';
      nextBtn.style.zIndex = '10';
      nextBtn.style.transition = 'background 0.3s';
      nextBtn.addEventListener('mouseover', () => nextBtn.style.backgroundColor = 'rgba(255,255,255,0.4)');
      nextBtn.addEventListener('click', (e) => {
        e.stopPropagation(); // 阻止关闭放大层
        showNextImage();
      });
      // 新增：关闭按钮
      const closeBtn = document.createElement('button');
      closeBtn.textContent = '× 关闭';
      closeBtn.style.position = 'absolute';
      closeBtn.style.top = '20px';
      closeBtn.style.padding = '8px 12px';
      closeBtn.style.backgroundColor = 'rgba(255,0,0,0.6)';
      closeBtn.style.color = 'white';
      closeBtn.style.border = 'none';
      closeBtn.style.borderRadius = '5px';
      closeBtn.style.fontSize = '16px';
      closeBtn.style.cursor = 'pointer';
      closeBtn.style.zIndex = '10';
      closeBtn.style.transition = 'background 0.3s';
      closeBtn.addEventListener('mouseover', () => closeBtn.style.backgroundColor = 'rgba(255,0,0,0.8)');
      closeBtn.addEventListener('click', () => {
        document.body.removeChild(overlay);
        document.removeEventListener('keydown', handleKeyDown); // 移除键盘监听
      });

      // 放大图片元素
      const overlayImg = document.createElement('img');
      overlayImg.src = img.src;
      overlayImg.alt = img.alt || `图片${index + 1}`;
      overlayImg.style.maxWidth = '90%';
      overlayImg.style.maxHeight = '80%';
      overlayImg.style.borderRadius = '5px';
      overlayImg.style.objectFit = 'contain'; // 保证图片不拉伸

      // 组装放大层
      overlay.appendChild(prevBtn);
      overlay.appendChild(nextBtn);
      overlay.appendChild(closeBtn);
      overlay.appendChild(overlayImg);

      // 点击空白处关闭
      overlay.addEventListener('click', () => {
        document.body.removeChild(overlay);
        document.removeEventListener('keydown', handleKeyDown);
      });

      // 新增：移动端触摸滑动支持
      let startX = 0;
      overlay.addEventListener('touchstart', (e) => {
        startX = e.touches[0].clientX; // 记录触摸起始位置
      });
      overlay.addEventListener('touchend', (e) => {
        if (!e.changedTouches[0]) return;
        const endX = e.changedTouches[0].clientX;
        const diffX = endX - startX; // 计算滑动距离
        if (diffX > 50) showPrevImage(); // 右滑→上一张
        if (diffX < -50) showNextImage(); // 左滑→下一张
      });

      // 新增：PC端键盘方向键控制
      function handleKeyDown(e) {
        if (e.key === 'ArrowLeft') showPrevImage(); // 左箭头→上一张
        if (e.key === 'ArrowRight') showNextImage(); // 右箭头→下一张
        if (e.key === 'Escape') { // ESC键→关闭
          document.body.removeChild(overlay);
          document.removeEventListener('keydown', handleKeyDown);
        }
      }
      document.addEventListener('keydown', handleKeyDown);

      // 加入页面
      document.body.appendChild(overlay);
    });
  });

  // 原有：YouTube视频墙逻辑（保留，无修改）
  const videos = [
    {id: "ZB9QSD_SWmM", type: "shorts", title: "最新 Shorts 视频"},
    {id: "ZB9QSD_SWmM", type: "shorts", title: "示例视频 1"},
    {id: "ZB9QSD_SWmM", type: "shorts", title: "示例视频 2"},
    {id: "ZB9QSD_SWmM", type: "video", title: "示例视频 2"},
    {id: "ZB9QSD_SWmM", type: "video", title: "示例视频 2"},
    {id: "ZB9QSD_SWmM", type: "video", title: "示例视频 2"}
  ];
  const feedContainer = document.getElementById("youtube-feed");
  if (feedContainer) {
    videos.forEach((v, index) => {
      const wrapper = document.createElement("div");
      wrapper.style.display = "flex";
      wrapper.style.flexDirection = "column";
      wrapper.style.gap = "5px";

      const iframeWrapper = document.createElement("div");
      iframeWrapper.style.position = "relative";
      iframeWrapper.style.width = "100%";
      iframeWrapper.style.height = 0;
      iframeWrapper.style.overflow = "hidden";
      iframeWrapper.style.borderRadius = "5px";
      iframeWrapper.style.paddingBottom = v.type === "shorts" ? "177.78%" : "56.25%";
      const iframeId = `video-iframe-${index}`;
      iframeWrapper.innerHTML = `<iframe src="https://www.youtube.com/embed/${v.id}?enablejsapi=1" 
              style="position:absolute;top:0;left:0;width:100%;height:100%;border:none;"
              title="${v.title}" 
              allowfullscreen
              id="${iframeId}"></iframe>`;

      const infoDiv = document.createElement("div");
      infoDiv.style.display = "flex";
      infoDiv.style.flexDirection = "column";
      infoDiv.style.alignItems = "center";
      infoDiv.style.gap = "5px";

      const titleEl = document.createElement("p");
      titleEl.textContent = v.title;
      titleEl.style.textAlign = "center";
      titleEl.style.margin = "0";
      titleEl.style.fontWeight = "bold";
      titleEl.style.fontSize = "14px";

      const btn = document.createElement("a");
      btn.href = `https://www.youtube.com/watch?v=${v.id}`;
      btn.target = "_blank";
      btn.textContent = "在 YouTube 上观看";
      btn.style.display = "inline-block";
      btn.style.padding = "5px 10px";
      btn.style.backgroundColor = "#ff0000";
      btn.style.color = "#fff";
      btn.style.borderRadius = "4px";
      btn.style.fontSize = "12px";
      btn.style.textDecoration = "none";

      infoDiv.appendChild(titleEl);
      infoDiv.appendChild(btn);
      wrapper.appendChild(iframeWrapper);
      wrapper.appendChild(infoDiv);
      feedContainer.appendChild(wrapper);

      const videoIframe = document.getElementById(iframeId);
      videoIframe.onload = () => {
        setTimeout(() => {
          const player = new YT.Player(iframeId, {
            events: {
              'onReady': (event) => {
                if (!window.globalYoutubePlayers) window.globalYoutubePlayers = [];
                if (!window.globalYoutubePlayers.includes(event.target)) {
                  window.globalYoutubePlayers.push(event.target);
                }
                event.target.mute();
                if (globalVolumeSlider) event.target.setVolume(globalVolumeSlider.value);
              }
            }
          });
        }, 500);
      };
    });
  }
  // 原有：PWA Service Worker 注册（保留）
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js')
      .then(registration => console.log('Service Worker 注册成功:', registration.scope))
      .catch(err => console.log('Service Worker 注册失败:', err));
  }

  // 原有：全局音量同步函数（保留）
  window.syncGlobalVolume = function(volume) {
    if (window.globalAudioElements) {
      window.globalAudioElements.forEach(audio => {
        if (audio) audio.volume = volume / 100;
      });
    }
    if (window.globalYoutubePlayers) {
      window.globalYoutubePlayers.forEach(player => {
        if (player && typeof player.setVolume === 'function') {
          player.setVolume(volume);
        }
      });
    }
    if (window.livePlayer) {
      window.livePlayer.setVolume(volume);
    }
  };

  // 原有：全局声音开关函数（保留）
  window.toggleGlobalSound = function() {
    window.isGlobalSoundOn = !window.isGlobalSoundOn;
    if (globalSoundBtn) {
      globalSoundBtn.textContent = window.isGlobalSoundOn ? '🔇 全局静音' : '🔊 全局有声';
    }
    if (window.globalAudioElements) {
      window.globalAudioElements.forEach(audio => {
        if (audio) audio.muted = !window.isGlobalSoundOn;
      });
    }
    if (window.globalYoutubePlayers) {
      window.globalYoutubePlayers.forEach(player => {
        if (player && typeof player.mute === 'function' && typeof player.unMute === 'function') {
          window.isGlobalSoundOn ? player.unMute() : player.mute();
        }
      });
    }
    if (window.livePlayer) {
      window.isGlobalSoundOn ? window.livePlayer.unMute() : window.livePlayer.mute();
    }
    const originalSoundBtn = document.getElementById('sound-toggle-btn');
    if (originalSoundBtn) {
      const originalIsOn = originalSoundBtn.textContent.includes('关闭');
      if (originalIsOn !== window.isGlobalSoundOn) {
        originalSoundBtn.click();
      }
    }
  };

  // 原有：PWA安装按钮逻辑（保留）
  const installBtn = document.getElementById('install-btn');
  let deferredPrompt;
  const isEdge = /Edg/i.test(navigator.userAgent);
  const isChrome = /Chrome/i.test(navigator.userAgent) && !isEdge;

  if (isChrome) {
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
    });
  }

  installBtn.addEventListener('click', async () => {
    if (isChrome) {
      if (!deferredPrompt) { alert("PWA 安装条件未满足，或已安装"); return; }
      deferredPrompt.prompt();
      await deferredPrompt.userChoice;
      deferredPrompt = null;
    } else if (isEdge) {
      alert("请通过浏览器菜单选择“点添加到手机或点安装或点创建快捷方式”来安装到手机或电脑或平板中使用。");
    } else {
      alert("当前浏览器不支持自动安装，请使用 Chrome 或 Edge 浏览器。");
    }
  });

  // 原有：绑定全局控制按钮事件（保留）
  if (globalSoundBtn) {
    globalSoundBtn.addEventListener('click', window.toggleGlobalSound);
  }
  if (globalVolumeSlider) {
    globalVolumeSlider.addEventListener('input', (e) => {
      const volume = e.target.value;
      window.syncGlobalVolume(volume);
    });
  }

}); // DOMContentLoaded 结束
</script>
<script>
// 原有：YouTube Player API 初始化相关变量（新增全局挂载）
window.livePlayer;
window.soundOn = false;

// 原有：onYouTubeIframeAPIReady函数（新增主播放器加入全局控制）
function onYouTubeIframeAPIReady() {
  const latestLiveID = 'fN9uYWCjQaw';
  window.livePlayer = new YT.Player('live-player', {
    videoId: latestLiveID,
    playerVars: { autoplay: 1, mute: 1, controls: 1, modestbranding: 1 },
    events: { 
      'onReady': (event) => { 
        event.target.mute(); 
        // 新增：将主直播播放器加入全局列表
        if (!window.globalYoutubePlayers) window.globalYoutubePlayers = [];
        if (!window.globalYoutubePlayers.includes(event.target)) {
          window.globalYoutubePlayers.push(event.target);
        }
        // 同步全局音量
        const globalSlider = document.getElementById('global-volume-slider');
        if (globalSlider) event.target.setVolume(globalSlider.value);
      } 
    }
  });
}

// 原有：右下角声音开关按钮（保留原逻辑，与全局控制联动）
const soundBtn = document.getElementById('sound-toggle-btn');
soundBtn.addEventListener('click', () => {
  if (!window.livePlayer) return;
  window.soundOn = !window.soundOn;
  // 更新原有按钮文字
  soundBtn.textContent = window.soundOn ? '🔇 关闭声音' : '🔊 打开声音';
  // 同步主直播播放器
  window.soundOn ? window.livePlayer.unMute() : window.livePlayer.mute();
  // 同步全局状态与其他音频/视频
  if (window.isGlobalSoundOn !== window.soundOn) {
    window.isGlobalSoundOn = window.soundOn;
    const globalSoundBtn = document.getElementById('global-sound-btn');
    if (globalSoundBtn) {
      globalSoundBtn.textContent = window.soundOn ? '🔇 全局静音' : '🔊 全局有声';
    }
    // 同步原生音频与其他YouTube播放器
    if (window.globalAudioElements) {
      window.globalAudioElements.forEach(audio => {
        if (audio) audio.muted = !window.soundOn;
      });
    }
    if (window.globalYoutubePlayers) {
      window.globalYoutubePlayers.forEach(player => {
        if (player !== window.livePlayer && player && typeof player.mute === 'function' && typeof player.unMute === 'function') {
          window.soundOn ? player.unMute() : player.mute();
        }
      });
    }
  }
});

// 原有：白天/夜晚模式切换按钮（保留原逻辑，无修改）
const modeBtn = document.getElementById('mode-toggle-btn');
const currentMode = localStorage.getItem('theme') || 'light'; // 默认使用 'light' 模式
if (currentMode === 'dark') {
  document.body.classList.add('dark-mode');
  modeBtn.textContent = "☀️ 白天模式";
} else {
  document.body.classList.remove('dark-mode');
  modeBtn.textContent = "🌙 夜晚模式";
}

modeBtn.addEventListener('click', () => {
  document.body.classList.toggle('dark-mode');
  if (document.body.classList.contains('dark-mode')) {
    modeBtn.textContent = "☀️ 白天模式";
    localStorage.setItem('theme', 'dark'); // 保存夜间模式
  } else {
    modeBtn.textContent = "🌙 夜晚模式";
    localStorage.setItem('theme', 'light'); // 保存白天模式
  }
});
</script>
</body>
</html>
