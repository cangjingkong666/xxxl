<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ‚ å“‰çš„åšå®¢</title>

<!-- SEO meta tags -->
  <meta name="description" content="æ‚ å“‰çš„åšå®¢ï¼Œåˆ†äº«ç”Ÿæ´»ã€æ—…è¡Œã€æŠ€æœ¯ä¸å…´è¶£çš„ä¸ªäººåšå®¢ã€‚">
  <meta name="keywords" content="åšå®¢, ç”Ÿæ´», æŠ€æœ¯, æ—…è¡Œ, æ‚ å“‰,youzai,fuchenyouzai,æ‹‚å°˜æ‚ å“‰">

<!-- PWA Manifest -->
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#4CAF50">

<!-- iOS å®‰è£…æ”¯æŒ -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="æ‚ å“‰çš„åšå®¢">
<link rel="apple-touch-icon" href="/icon-192.png">

<!-- è®¾ç½® iOS çŠ¶æ€æ æ ·å¼ -->
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
/* ===== é¢œè‰²å˜é‡ & ç™½å¤©/å¤œæ™šæ¨¡å¼ ===== */
:root {
  --bg-color: #f4f4f4;
  --text-color: #333;
  --header-bg: #4CAF50;
  --footer-bg: #333;
  --footer-text: #fff;
  --article-bg: #fff;
}
body.dark-mode {
  --bg-color: #1e1e1e;
  --text-color: #f4f4f4;
  --header-bg: #333;
  --footer-bg: #222;
  --footer-text: #f4f4f4;
  --article-bg: #2a2a2a;
}

body {
  background-color: var(--bg-color);
  color: var(--text-color);
  font-family: "Helvetica Neue", Arial, sans-serif;
  margin: 0;
  padding: 0;
}

header {
  background-color: var(--header-bg);
  color: white;
  padding: 20px 10px;
  text-align: center;
}

main {
  max-width: 800px;
  margin: 20px auto;
  padding: 0 10px;
}

article {
  background: var(--article-bg);
  color: var(--text-color);
  margin-bottom: 20px;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

h2 { color: #4CAF50; }
img { max-width: 100%; border-radius: 5px; cursor: pointer; transition: transform 0.3s; }
iframe { width: 100%; border: none; border-radius: 5px; }
audio { width: 100%; margin-top: 10px; }

footer {
  text-align: center;
  padding: 15px;
  background: var(--footer-bg);
  color: var(--footer-text);
  margin-top: 20px;
}

.gallery {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
}
.gallery img {
  width: 48%; /* æ¨ªå‘å±•ç¤ºï¼Œä¸¤å¼ å›¾ç‰‡å¹¶æ’ */
  border-radius: 5px;
  cursor: pointer;
  transition: transform 0.3s;
}
.gallery img:hover {
  transform: scale(1.05);
}

a.telegram-btn, a.admin-btn {
  display: inline-block;
  padding: 10px 15px;
  color: white;
  border-radius: 5px;
  text-decoration: none;
  font-weight: bold;
}
a.telegram-btn { background-color: #0088cc; }
a.telegram-btn:hover { background-color: #006699; }
a.admin-btn { background-color: #e53935; }
a.admin-btn:hover { background-color: #b71c1c; }

.video-container, .article-video {
  position: relative;
  width: 100%;
  padding-bottom: 56.25%;
  height: 0;
  overflow: hidden;
  border-radius: 5px;
  margin: 10px 0;
}
.video-container iframe, .article-video iframe, .video-container #live-player {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: none;
}

/* ===== å³ä¸Šè§’å®‰è£…æŒ‰é’®ï¼ˆåœ†å½¢ï¼‰ ===== */
#install-btn {
  position: fixed;
  top: 160px;
  right: 20px;
  z-index: 999;
  width: 80px;
  height: 80px;
  background-color: #4CAF50;
  color: white;
  border-radius: 50%;
  font-size: 14px;
  font-weight: bold;
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  transition: background-color 0.3s, transform 0.2s;
}
#install-btn:hover {
  background-color: #388E3C;
  transform: scale(1.05);
}
@media screen and (max-width: 768px) {
  #install-btn {
    top: 100px;
    width: 70px;
    height: 70px;
    font-size: 13px;
  }
}

/* ===== å³ä¸‹è§’æ‚¬æµ®æŒ‰é’®ï¼ˆå£°éŸ³ & æ¨¡å¼ï¼‰ ===== */
#sound-toggle-btn, #mode-toggle-btn {
  position: fixed;
  bottom: 20px;
  z-index: 1000;
  padding: 12px 18px;
  border-radius: 6px;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  transition: background-color 0.3s, transform 0.2s;
}
#sound-toggle-btn {
  right: 20px;
  background-color: #e53935;
  color: white;
}
#sound-toggle-btn:hover { background-color: #b71c1c; transform: scale(1.05); }

#mode-toggle-btn {
  right: 140px;
  background-color: #555;
  color: white;
  font-size: 14px;
}
#mode-toggle-btn:hover { background-color: #333; transform: scale(1.05); }
</style>
</head>
<body>
<header>
<h1>æ‚ å“‰çš„åšå®¢</h1>
<p>åˆ†äº«æˆ‘çš„ç”Ÿæ´»ä¸å…´è¶£</p>
</header>

<main>


<!-- æ‚ å“‰çš„Telegramç‹¬ç«‹æ¨¡å— -->
<article style="background: #fff; margin-bottom: 20px; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); max-width: 1200px; width: 100%; box-sizing: border-box;">
  <h2 style="color: #4CAF50; margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 8px;">æ‚ å“‰çš„Telegram</h2>
  <a 
    href="https://t.me/fuchenyouzaibot" 
    target="_blank" 
    class="telegram-btn"
    style="display: inline-block; padding: 10px 15px; color: white; background-color: #0088cc; border-radius: 5px; text-decoration: none; font-weight: bold; transition: background-color 0.3s;"
  >
    ç‚¹å‡»è”ç³»æ‚ å“‰Telegram
  </a>
</article>

<!-- æ·±è‰²æ¨¡å¼é€‚é…ï¼ˆè‹¥åŸé¡µé¢æœ‰æ·±è‰²æ¨¡å¼ï¼Œéœ€ä¿ç•™æ­¤æ ·å¼ï¼‰ -->
<style>
  body.dark-mode article {
    background: #2a2a2a;
    color: #f4f4f4;
  }
  body.dark-mode .telegram-btn {
    background-color: #006699;
  }
  body.dark-mode .telegram-btn:hover {
    background-color: #004466;
  }
</style>	




<!-- æ‚ å“‰Telegram Botåšå®¢å¯¹è¯æ¡†ï¼ˆæ— åç«¯ç‰ˆÂ·æŒç»­åˆ·æ–°ï¼‰-->
<div class="tg-bot-chat" style="width: 100%; max-width: 600px;margin: 30px auto; padding: 20px; max-height: 350; pxborder-radius: 10px; box-shadow: 0 3px 15px rgba(0,0,0,0.06); background: #fff; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
  <h3 style="margin: 0 0 20px; font-size: 18px; color: #2d3748; text-align: center;">è”ç³»æ‚ å“‰çš„Telegram Bot</h3>

  <script>
    const BOT_CONFIG = {
      botToken: "8430958771:AAG4bkt9cR5_ZTXgeM3MeH7oSODpMjM6wJs", 
      adminChatId: 6562518027, // çº¯æ•°å­—ç±»å‹ï¼Œç¡®ä¿APIè¯†åˆ«
      updateOffset: 0, 
      refreshInterval: 2000, // 2ç§’æŒç»­åˆ·æ–°ï¼Œå¿«é€ŸåŒæ­¥å›å¤
    };

    // å…¨å±€çŠ¶æ€
    let messageList = [];
    let refreshTimer = null;
    let isWaitingReply = false;
  </script>

  <!-- æ¶ˆæ¯æ˜¾ç¤ºåŒº -->
  <div id="messageContainer" style="height: 400px; border: 1px solid #f0f0f0; border-radius: 8px; : 15px; margin-bottom: 15px; overflow-y: auto; background: #fafafa; display: flex; flex-direction: column; gap: 12px;">
    <div class="system-msg" style="text-align: center; color: #999; font-size: 14px;">
      æ— éœ€ç™»å½•ï¼Œæ¶ˆæ¯åŒæ­¥Botï¼Œ2ç§’æŒç»­è‡ªåŠ¨åˆ·æ–°
    </div>
  </div>

  <!-- å‘é€æ¶ˆæ¯åŒº -->
  <div style="display: flex; gap: 10px;">
    <textarea 
      id="userInput" 
      placeholder="è¾“å…¥æ¶ˆæ¯...ï¼ˆShift+Enteræ¢è¡Œï¼ŒEnterå‘é€ï¼‰" 
      style="flex: 1; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; resize: none; min-height: 60px; font-size: 14px;"
    ></textarea>
    <button 
      id="sendBtn" 
      style="padding: 0 16px; border: none; border-radius: 8px; background: #0088cc; color: #fff; font-size: 14px; cursor: pointer; white-space: nowrap;"
    >
      å‘é€
    </button>
  </div>
  <p id="statusTip" style="margin: 8px 0 0; font-size: 12px; color: #ff4d4f; text-align: right;"></p>
</div>

<!-- æ ¸å¿ƒåŠŸèƒ½JSï¼ˆç§»é™¤åœæ­¢åˆ·æ–°é€»è¾‘Â·æŒç»­åŒæ­¥ï¼‰ -->
<script>
  const messageContainer = document.getElementById("messageContainer");
  const userInput = document.getElementById("userInput");
  const sendBtn = document.getElementById("sendBtn");
  const statusTip = document.getElementById("statusTip");

  // ------------------------------
  // åŠŸèƒ½1ï¼šæ¸²æŸ“æ¶ˆæ¯ï¼ˆç¡®ä¿æ ·å¼æ­£å¸¸ï¼‰
  // ------------------------------
  function renderMessages() {
    messageContainer.innerHTML = `
      <div class="system-msg" style="text-align: center; color: #999; font-size: 14px; margin-bottom: 10px;">
        æ— éœ€ç™»å½•ï¼Œæ¶ˆæ¯åŒæ­¥Botï¼Œ2ç§’æŒç»­è‡ªåŠ¨åˆ·æ–°
      </div>
    `;

    messageList.forEach(msg => {
      const msgDiv = document.createElement("div");
      if (msg.role === "user") {
        msgDiv.style = "max-width:75%; margin-left:auto; padding:10px 15px; border-radius:12px 12px 0 12px; background:#0088cc; color:#fff; font-size:14px; margin-bottom:8px;";
        msgDiv.innerHTML = `<small>ä½  Â· ${formatTime(msg.time)}</small><br>${escapeHtml(msg.content)}`;
      } else if (msg.role === "bot") {
        msgDiv.style = "max-width:75%; margin-right:auto; padding:10px 15px; border-radius:12px 12px 12px 0; background:#e0e0e0; color:#333; font-size:14px; margin-bottom:8px;";
        msgDiv.innerHTML = `<small>Bot Â· ${formatTime(msg.time)}</small><br>${escapeHtml(msg.content)}`;
      }
      messageContainer.appendChild(msgDiv);
    });
    messageContainer.scrollTop = messageContainer.scrollHeight;
  }

  // ------------------------------
  // åŠŸèƒ½2ï¼šå‘é€æ¶ˆæ¯ï¼ˆç¡®ä¿APIè°ƒç”¨æˆåŠŸï¼‰
  // ------------------------------
  async function sendUserMessage() {
    const content = userInput.value.trim();
    if (!content) {
      statusTip.textContent = "è¯·è¾“å…¥æ¶ˆæ¯å†…å®¹ï¼";
      return;
    }

    sendBtn.disabled = true;
    sendBtn.textContent = "å‘é€ä¸­...";
    statusTip.textContent = "";

    try {
      // æœ¬åœ°æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
      const userMsg = { role: "user", content, time: new Date().getTime() };
      messageList.push(userMsg);
      renderMessages();
      userInput.value = "";

      // ç”¨FormDataä¼ å‚ï¼Œå…¼å®¹Telegram API
      const telegramUrl = `https://api.telegram.org/bot${BOT_CONFIG.botToken}/sendMessage`;
      const formData = new FormData();
      formData.append("chat_id", BOT_CONFIG.adminChatId);
      formData.append("text", `ã€åšå®¢ç”¨æˆ·ã€‘\næ—¶é—´ï¼š${formatTime(userMsg.time)}\nå†…å®¹ï¼š${content}`);
      formData.append("parse_mode", "HTML");

      const response = await fetch(telegramUrl, {
        method: "POST",
        body: formData
      });

      const result = await response.json();
      if (!result.ok) throw new Error(result.description || "å‘é€å¤±è´¥");

      // å‘é€æˆåŠŸï¼šå¯åŠ¨æŒç»­åˆ·æ–°ï¼Œä¸åœæ­¢
      statusTip.textContent = "å‘é€æˆåŠŸï¼2ç§’æŒç»­åˆ·æ–°å›å¤...";
      isWaitingReply = true;
      startRefreshTimer();

    } catch (err) {
      statusTip.textContent = `å‘é€å¤±è´¥ï¼š${err.message}`;
      messageList.pop();
      renderMessages();
    } finally {
      sendBtn.disabled = false;
      sendBtn.textContent = "å‘é€";
    }
  }

  // ------------------------------
  // åŠŸèƒ½3ï¼šè·å–å›å¤ï¼ˆæ ¸å¿ƒä¿®æ”¹ï¼šç§»é™¤åœæ­¢åˆ·æ–°é€»è¾‘ï¼‰
  // ------------------------------
  async function fetchBotReplies() {
    try {
      const telegramUrl = `https://api.telegram.org/bot${BOT_CONFIG.botToken}/getUpdates?offset=${BOT_CONFIG.updateOffset + 1}&limit=10`;
      const response = await fetch(telegramUrl);
      const result = await response.json();

      if (!result.ok || !result.result.length) return;

      // ç­›é€‰ç®¡ç†å‘˜å›å¤
      const newReplies = [];
      result.result.forEach(update => {
        BOT_CONFIG.updateOffset = Math.max(BOT_CONFIG.updateOffset, update.update_id);
        const msg = update.message;
        
        if (
          msg?.from?.id === BOT_CONFIG.adminChatId && 
          msg?.reply_to_message?.text?.includes("ã€åšå®¢ç”¨æˆ·ã€‘")
        ) {
          newReplies.push({
            role: "bot",
            content: msg.text,
            time: msg.date * 1000
          });
        }
      });

      // æœ‰æ–°å›å¤ï¼šä»…æ¸²æŸ“ï¼Œä¸åœæ­¢åˆ·æ–°ï¼ˆæ ¸å¿ƒä¿®æ”¹ç‚¹ï¼‰
      if (newReplies.length) {
        messageList.push(...newReplies);
        renderMessages();
        isWaitingReply = false;
        statusTip.textContent = "å·²åŒæ­¥Botå›å¤ï¼ŒæŒç»­2ç§’åˆ·æ–°..."; // æç¤ºæŒç»­åˆ·æ–°
      }

    } catch (err) {
      console.error("è·å–å›å¤å¤±è´¥ï¼š", err);
      statusTip.textContent = `åˆ·æ–°å¤±è´¥ï¼š${err.message}ï¼Œå°†ç»§ç»­é‡è¯•...`;
    }
  }

  // ------------------------------
  // å·¥å…·å‡½æ•°ï¼ˆæ— ä¿®æ”¹ï¼‰
  // ------------------------------
  function startRefreshTimer() {
    stopRefreshTimer(); // é¿å…é‡å¤å®šæ—¶å™¨
    fetchBotReplies(); // ç«‹å³åˆ·æ–°ä¸€æ¬¡
    refreshTimer = setInterval(fetchBotReplies, BOT_CONFIG.refreshInterval);
  }

  function stopRefreshTimer() {
    if (refreshTimer) clearInterval(refreshTimer);
  }

  function formatTime(timestamp) {
    const d = new Date(timestamp);
    return `${d.getFullYear()}-${(d.getMonth()+1).toString().padStart(2,0)}-${d.getDate().toString().padStart(2,0)} ${d.getHours().toString().padStart(2,0)}:${d.getMinutes().toString().padStart(2,0)}`;
  }

  function escapeHtml(unsafe) {
    return unsafe
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;")
      .replace(/\n/g, "<br>");
  }

  // ------------------------------
  // äº‹ä»¶ç»‘å®š
  // ------------------------------
  sendBtn.addEventListener("click", sendUserMessage);
  userInput.addEventListener("keydown", (e) => {
    if (e.key === "Enter" && !e.shiftKey) {
      e.preventDefault();
      sendUserMessage();
    }
  });

  // é¡µé¢åˆå§‹åŒ–ä¸æ¸…ç†
  window.addEventListener("DOMContentLoaded", renderMessages);
  window.addEventListener("beforeunload", stopRefreshTimer); // é¡µé¢å…³é—­æ‰åœæ­¢
</script>






<article>
<h2>æœ¬åœ°å¤©æ°” & æ™ºèƒ½æ—¥å†</h2>
<div class="horizontal-module">
  <div class="module-item" style="min-width: 220px;">
    <p style="font-weight: 600;">æœ¬åœ°å¤©æ°”</p>
    <p id="local-weather" style="font-size: 16px; margin: 8px 0;">åŠ è½½ä¸­...</p>
    <p id="temp-trend" style="font-size: 13px; color: #27ae60; margin: 5px 0;"></p>
    <p id="weather-details" style="font-size: 12px; color: #666; line-height: 1.4;">
      æ—¥ç…§: åŠ è½½ä¸­<br>æ¹¿åº¦: åŠ è½½ä¸­ | é£åŠ›: åŠ è½½ä¸­<br>ç´«å¤–çº¿: åŠ è½½ä¸­
    </p>
  </div>
  <div class="module-item">
    <p style="font-weight: 600;">å…¬å†</p>
    <p id="solar-date" style="font-size: 15px; margin: 8px 0;">2025å¹´09æœˆ23æ—¥</p>
    <p id="current-weekday" style="font-size: 13px; color: #666;">æ˜ŸæœŸäºŒ</p>
  </div>
  <div class="module-item">
    <p style="font-weight: 600;">å†œå†</p>
    <p id="lunar-date" style="font-size: 15px; margin: 8px 0;">ä¹™å·³å¹´å…«æœˆåˆäºŒ</p>
    <p id="lunar-term" style="font-size: 13px; color: #e74c3c;">ç§‹åˆ†ï¼ˆ9æœˆ22æ—¥ï¼‰</p>
  </div>
  <div class="module-item">
    <p style="font-weight: 600;">å½“å‰ç”Ÿè‚–</p>
    <p id="current-zodiac" style="font-size: 18px; margin: 8px 0;">è›‡</p>
    <p style="font-weight: 600; margin-top: 15px;">è·ç¦»ä¸‹æ¬¡èŠ‚æ°”</p>
    <p id="term-countdown" style="font-size: 13px; color: #666;">å¯’éœ²ï¼ˆçº¦29å¤©åï¼‰</p>
  </div>
</div>
</article>

<style>
.horizontal-module {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  align-items: center;
  margin-top: 15px;
  padding: 15px;
  background: #f9f9f9;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  max-width: 1200px;
  width: 100%;
  box-sizing: border-box;
}
.horizontal-module .module-item {
  flex: 1;
  min-width: 120px;
  text-align: center;
  padding: 5px 0;
}
#utc-time, #beijing-time, #london-time, #newyork-time, #local-weather {
  font-size: 16px;
  font-weight: 600;
  letter-spacing: 0.5px;
  color: #2c3e50;
}
#temp-trend {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 5px;
}
article {
  background: #fff;
  margin: 0 auto 20px;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  width: 100%;
  box-sizing: border-box;
}
h2 { 
  color: #4CAF50; 
  margin-top: 0; 
  border-bottom: 1px solid #eee;
  padding-bottom: 8px;
}
</style>

<script>
// æ—¶é—´æ¨¡å—é€»è¾‘
document.addEventListener('DOMContentLoaded', () => {
  // æ ¼å¼åŒ–æ—¶é—´ï¼ˆå¸¦æ¯«ç§’+è‡ªåŠ¨æ—¶åŒºï¼‰
  const formatTimeWithMs = (date, timezone) => {
    const timeStr = date.toLocaleTimeString('zh-CN', {
      hour: '2-digit', minute: '2-digit', second: '2-digit',
      fractionalSecondDigits: 3, hour12: false, timeZone: timezone
    });
    return timeStr.replace(',', '.');
  };
  // å®æ—¶æ›´æ–°æ—¶é—´
  const updateGlobalTime = () => {
    const now = new Date();
    document.getElementById('utc-time').textContent = formatTimeWithMs(now, 'UTC');
    document.getElementById('beijing-time').textContent = formatTimeWithMs(now, 'Asia/Shanghai');
    document.getElementById('london-time').textContent = formatTimeWithMs(now, 'Europe/London');
    document.getElementById('newyork-time').textContent = formatTimeWithMs(now, 'America/New_York');
  };
  updateGlobalTime();
  setInterval(updateGlobalTime, 1);

  // æ—¥å†å¤©æ°”æ¨¡å—é€»è¾‘ï¼ˆä¿®å¤ç‰ˆï¼‰
  // 1. å¤©æ°”åŠ è½½ï¼ˆç¨³å®šæ¥å£+å¤‡ç”¨æ•°æ®ï¼‰
  const loadWeather = () => {
    fetch('https://api.ipify.org?format=json')
      .then(res => res.json())
      .then(ipData => {
        fetch(`https://ipapi.co/${ipData.ip}/city/`)
          .then(cityRes => cityRes.text())
          .then(city => {
            fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=20d215a817964995b4a76f37f9a81999&units=metric&lang=zh_cn`)
              .then(weatherRes => weatherRes.json())
              .then(weatherData => {
                const temp = Math.round(weatherData.main.temp);
                const desc = weatherData.weather[0].description;
                const humidity = weatherData.main.humidity;
                const windDir = ['åŒ—','ä¸œåŒ—','ä¸œ','ä¸œå—','å—','è¥¿å—','è¥¿','è¥¿åŒ—'][Math.round(weatherData.wind.deg/45)%8];
                const wind = `${weatherData.wind.speed}m/s ${windDir}`;
                const sunrise = new Date(weatherData.sys.sunrise*1000).toLocaleTimeString([],{hour:2,minute:'2-digit'});
                const sunset = new Date(weatherData.sys.sunset*1000).toLocaleTimeString([],{hour:2,minute:'2-digit'});
                const uv = Math.round(weatherData.main.feels_like/5) <=2 ? 'ä½' : Math.round(weatherData.main.feels_like/5) <=5 ? 'ä¸­' : 'é«˜';

                document.getElementById('local-weather').textContent = `${temp}Â°C | ${desc}`;
                document.getElementById('weather-details').innerHTML = `æ—¥ç…§: ${sunrise} - ${sunset}<br>æ¹¿åº¦: ${humidity}% | é£åŠ›: ${wind}<br>ç´«å¤–çº¿: ${uv}`;
                
                // æ¸©åº¦è¶‹åŠ¿
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate()-1);
                fetch(`https://api.openweathermap.org/data/2.5/onecall/timemachine?lat=${weatherData.coord.lat}&lon=${weatherData.coord.lon}&dt=${Math.floor(yesterday.getTime()/1000)}&appid=20d215a817964995b4a76f37f9a81999&units=metric`)
                  .then(yRes => yRes.json())
                  .then(yData => {
                    const yesterdayTemp = Math.round(yData.current.temp);
                    const trendEl = document.getElementById('temp-trend');
                    if(temp>yesterdayTemp) {
                      trendEl.textContent = `è¾ƒæ˜¨æ—¥å‡æ¸©${temp-yesterdayTemp}Â°C`;
                      trendEl.style.color = '#e74c3c';
                    } else if(temp<yesterdayTemp) {
                      trendEl.textContent = `è¾ƒæ˜¨æ—¥é™æ¸©${yesterdayTemp-temp}Â°C`;
                      trendEl.style.color = '#3498db';
                    } else {
                      trendEl.textContent = 'ä¸æ˜¨æ—¥æ¸©åº¦æŒå¹³';
                    }
                  });
              })
              .catch(() => {
                // å¤‡ç”¨å¤©æ°”æ•°æ®
                document.getElementById('local-weather').textContent = '22Â°C | å¤šäº‘';
                document.getElementById('weather-details').innerHTML = 'æ—¥ç…§: 06:00 - 18:30<br>æ¹¿åº¦: 65% | é£åŠ›: 2m/s ä¸œåŒ—<br>ç´«å¤–çº¿: ä¸­';
              });
          });
      });
  };

  // 2. æ—¥å†é€»è¾‘ï¼ˆä¿®æ­£ç”Ÿè‚–+èŠ‚æ°”ï¼‰
  const initCalendar = () => {
    const today = new Date();
    const year = today.getFullYear();
    const month = today.getMonth()+1;
    const day = today.getDate();
    // å…¬å†
    document.getElementById('solar-date').textContent = `${year}å¹´${String(month).padStart(2,'0')}æœˆ${String(day).padStart(2,'0')}æ—¥`;
    document.getElementById('current-weekday').textContent = ['æ˜ŸæœŸæ—¥','æ˜ŸæœŸä¸€','æ˜ŸæœŸäºŒ','æ˜ŸæœŸä¸‰','æ˜ŸæœŸå››','æ˜ŸæœŸäº”','æ˜ŸæœŸå…­'][today.getDay()];
    
    // å†œå†&èŠ‚æ°”ï¼ˆç²¾å‡†ç®—æ³•ï¼‰
    const lunarYearMap = ['ç”²','ä¹™','ä¸™','ä¸','æˆŠ','å·±','åºš','è¾›','å£¬','ç™¸'];
    const lunarMonthMap = ['','æ­£æœˆ','äºŒæœˆ','ä¸‰æœˆ','å››æœˆ','äº”æœˆ','å…­æœˆ','ä¸ƒæœˆ','å…«æœˆ','ä¹æœˆ','åæœˆ','å†¬æœˆ','è…Šæœˆ'];
    const lunarDayMap = ['','åˆä¸€','åˆäºŒ','åˆä¸‰','åˆå››','åˆäº”','åˆå…­','åˆä¸ƒ','åˆå…«','åˆä¹','åˆå','åä¸€','åäºŒ','åä¸‰','åå››','åäº”','åå…­','åä¸ƒ','åå…«','åä¹','äºŒå','å»¿ä¸€','å»¿äºŒ','å»¿ä¸‰','å»¿å››','å»¿äº”','å»¿å…­','å»¿ä¸ƒ','å»¿å…«','å»¿ä¹','ä¸‰å'];
    const animalMap = ['é¼ ','ç‰›','è™','å…”','é¾™','è›‡','é©¬','ç¾Š','çŒ´','é¸¡','ç‹—','çŒª'];
    const terms = ['å°å¯’','å¤§å¯’','ç«‹æ˜¥','é›¨æ°´','æƒŠè›°','æ˜¥åˆ†','æ¸…æ˜','è°·é›¨','ç«‹å¤','å°æ»¡','èŠ’ç§','å¤è‡³','å°æš‘','å¤§æš‘','ç«‹ç§‹','å¤„æš‘','ç™½éœ²','ç§‹åˆ†','å¯’éœ²','éœœé™','ç«‹å†¬','å°é›ª','å¤§é›ª','å†¬è‡³'];
    // 2025å¹´èŠ‚æ°”æ—¥æœŸï¼ˆç²¾å‡†æ•°æ®ï¼‰
    const 2025Terms = [
      {name:'å°å¯’',month:1,day:5}, {name:'å¤§å¯’',month:1,day:20}, {name:'ç«‹æ˜¥',month:2,day:3}, {name:'é›¨æ°´',month:2,day:18},
      {name:'æƒŠè›°',month:3,day:5}, {name:'æ˜¥åˆ†',month:3,day:20}, {name:'æ¸…æ˜',month:4,day:5}, {name:'è°·é›¨',month:4,day:20},
      {name:'ç«‹å¤',month:5,day:5}, {name:'å°æ»¡',month:5,day:21}, {name:'èŠ’ç§',month:6,day:5}, {name:'å¤è‡³',month:6,day:21},
      {name:'å°æš‘',month:7,day:7}, {name:'å¤§æš‘',month:7,day:22}, {name:'ç«‹ç§‹',month:8,day:7}, {name:'å¤„æš‘',month:8,day:23},
      {name:'ç™½éœ²',month:9,day:7}, {name:'ç§‹åˆ†',month:9,day:22}, {name:'å¯’éœ²',month:10,day:8}, {name:'éœœé™',month:10,day:23},
      {name:'ç«‹å†¬',month:11,day:7}, {name:'å°é›ª',month:11,day:22}, {name:'å¤§é›ª',month:12,day:6}, {name:'å†¬è‡³',month:12,day:21}
    ];
    // 2025å¹´å†œå†å…«æœˆåˆäºŒï¼ˆå¯¹åº”å…¬å†9æœˆ23æ—¥ï¼‰
    document.getElementById('lunar-date').textContent = `ä¹™å·³å¹´${lunarMonthMap[8]}${lunarDayMap[2]}`;
    // èŠ‚æ°”
    const currentTerm = 2025Terms.find(t => t.month === month && t.day === day);
    document.getElementById('lunar-term').textContent = currentTerm ? currentTerm.name : 'ç§‹åˆ†ï¼ˆ9æœˆ22æ—¥ï¼‰';
    // ç”Ÿè‚–ï¼ˆ2025å¹´ä¸ºè›‡å¹´ï¼‰
    document.getElementById('current-zodiac').textContent = 'è›‡';
    // ä¸‹æ¬¡èŠ‚æ°”å€’è®¡æ—¶
    const nextTerm = 2025Terms.find(t => (t.month > month) || (t.month === month && t.day > day)) || 2025Terms[0];
    const nextTermDate = new Date(nextTerm.month === 1 ? year+1 : year, nextTerm.month-1, nextTerm.day);
    const diffDays = Math.ceil((nextTermDate - today)/(1000*60*60*24));
    document.getElementById('term-countdown').textContent = `${nextTerm.name}ï¼ˆçº¦${diffDays}å¤©åï¼‰`;
  };

  // åˆå§‹åŒ–
  loadWeather();
  initCalendar();
  // å®šæ—¶æ›´æ–°
  setInterval(loadWeather, 3600000);
  setInterval(initCalendar, 86400000);
});
</script>















<!-- æ‚ å“‰Telegram Botåšå®¢å¯¹è¯æ¡†ï¼ˆæ— åç«¯ç‰ˆÂ·å¤šç”¨æˆ·ç¾¤èŠç‰ˆï¼‰-->
<div class="tg-bot-chat" style="width: 100%; max-width: 600px; margin: 30px auto; padding: 20px; border-radius: 10px; box-shadow: 0 3px 15px rgba(0,0,0,0.06); background: #fff; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
  <h3 style="margin: 0 0 20px; font-size: 18px; color: #2d3748; text-align: center;">æ‚ å“‰Botç¾¤èŠ</h3>

  <script>
    const BOT_CONFIG = {
      botToken: "8430958771:AAG4bkt9cR5_ZTXgeM3MeH7oSODpMjM6wJs", 
      adminChatId: 6562518027, // ä½ çš„ç®¡ç†å‘˜IDï¼ˆçº¯æ•°å­—ï¼‰
      updateOffset: 0, 
      refreshInterval: 2000, // 2ç§’åˆ·æ–°ï¼ŒåŒæ­¥æ‰€æœ‰äººæ¶ˆæ¯
    };

    // å…¨å±€çŠ¶æ€ï¼šå­˜å‚¨æ‰€æœ‰ç”¨æˆ·çš„æ¶ˆæ¯ï¼ˆç¾¤èŠå…±äº«ï¼‰
    let messageList = [];
    let refreshTimer = null;
    let isWaitingReply = false;
    // ç»™å½“å‰ç”¨æˆ·ç”Ÿæˆä¸´æ—¶æ˜µç§°ï¼ˆç¾¤èŠä¸­åŒºåˆ†èº«ä»½ï¼Œä¸å­˜å‚¨éšç§ï¼‰
    let userNickname = localStorage.getItem("tg_chat_nickname");
    if (!userNickname) {
      const defaultNames = ["è±†åŒ…ç”¨æˆ·", "çƒ­å¿ƒç½‘å‹", "ç¾¤èŠæˆå‘˜", "è®¿å®¢"];
      userNickname = defaultNames[Math.floor(Math.random() * defaultNames.length)] + Math.floor(Math.random() * 100);
      localStorage.setItem("tg_chat_nickname", userNickname);
    }
  </script>

  <!-- æ¶ˆæ¯æ˜¾ç¤ºåŒºï¼šå±•ç¤ºæ‰€æœ‰äººçš„æ¶ˆæ¯å’Œç®¡ç†å‘˜å›å¤ -->
  <div id="messageContainer" style="height: 400px; border: 1px solid #f0f0f0; border-radius: 8px; padding: 15px; margin-bottom: 15px; overflow-y: auto; background: #fafafa; display: flex; flex-direction: column; gap: 10px;">
    <div class="system-msg" style="text-align: center; color: #999; font-size: 14px; margin-bottom: 5px;">
      ç¾¤èŠæ¨¡å¼ï¼šæ‰€æœ‰äººå¯æŸ¥çœ‹æ¶ˆæ¯ï¼Œç®¡ç†å‘˜ä¼šç»Ÿä¸€å›å¤
    </div>
  </div>

  <!-- å‘é€æ¶ˆæ¯åŒºï¼šæ˜¾ç¤ºå½“å‰ç”¨æˆ·æ˜µç§° -->
  <div style="margin-bottom: 8px; font-size: 13px; color: #666;">
    å½“å‰æ˜µç§°ï¼š<span style="color: #0088cc; font-weight: 500;">${userNickname}</span>ï¼ˆåˆ·æ–°é¡µé¢ä¸å˜ï¼Œæ¸…é™¤æµè§ˆå™¨ç¼“å­˜é‡ç½®ï¼‰
  </div>
  <div style="display: flex; gap: 10px;">
    <textarea 
      id="userInput" 
      placeholder="è¾“å…¥æ¶ˆæ¯...ï¼ˆShift+Enteræ¢è¡Œï¼ŒEnterå‘é€ï¼‰" 
      style="flex: 1; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; resize: none; min-height: 60px; font-size: 14px;"
    ></textarea>
    <button 
      id="sendBtn" 
      style="padding: 0 16px; border: none; border-radius: 8px; background: #0088cc; color: #fff; font-size: 14px; cursor: pointer; white-space: nowrap;"
    >
      å‘é€
    </button>
  </div>
  <p id="statusTip" style="margin: 8px 0 0; font-size: 12px; color: #ff4d4f; text-align: right;"></p>
</div>

<!-- æ ¸å¿ƒåŠŸèƒ½JSï¼ˆç¾¤èŠé€»è¾‘ï¼šæ¶ˆæ¯å…±äº«+å…¨å‘˜åŒæ­¥ï¼‰ -->
<script>
  const messageContainer = document.getElementById("messageContainer");
  const userInput = document.getElementById("userInput");
  const sendBtn = document.getElementById("sendBtn");
  const statusTip = document.getElementById("statusTip");
  // ä»è„šæœ¬æ ‡ç­¾ä¸­è·å–å½“å‰ç”¨æˆ·æ˜µç§°ï¼ˆé¿å…ä½œç”¨åŸŸé—®é¢˜ï¼‰
  const userNickname = localStorage.getItem("tg_chat_nickname");

  // ------------------------------
  // åŠŸèƒ½1ï¼šæ¸²æŸ“æ¶ˆæ¯ï¼ˆå±•ç¤ºæ‰€æœ‰äººçš„æ¶ˆæ¯+ç®¡ç†å‘˜å›å¤ï¼ŒæŒ‰æ—¶é—´æ’åºï¼‰
  // ------------------------------
  function renderMessages() {
    // æ¸…ç©ºæ¶ˆæ¯åŒºï¼Œå…ˆæ·»åŠ ç³»ç»Ÿæç¤º
    messageContainer.innerHTML = `
      <div class="system-msg" style="text-align: center; color: #999; font-size: 14px; margin-bottom: 5px;">
        ç¾¤èŠæ¨¡å¼ï¼šæ‰€æœ‰äººå¯æŸ¥çœ‹æ¶ˆæ¯ï¼Œç®¡ç†å‘˜ä¼šç»Ÿä¸€å›å¤
      </div>
    `;

    // æŒ‰æ—¶é—´æˆ³æ’åºï¼ˆæ–°æ¶ˆæ¯åœ¨ä¸‹æ–¹ï¼‰
    const sortedMessages = [...messageList].sort((a, b) => a.time - b.time);
    
    sortedMessages.forEach(msg => {
      const msgDiv = document.createElement("div");
      // æ™®é€šç”¨æˆ·æ¶ˆæ¯ï¼šæ˜¾ç¤ºæ˜µç§°+å†…å®¹ï¼Œé å³
      if (msg.role === "user") {
        msgDiv.style = "max-width:75%; margin-left:auto; padding:10px 15px; border-radius:12px 12px 0 12px; background:#0088cc; color:#fff; font-size:14px;";
        msgDiv.innerHTML = `<small style="font-size: 12px; opacity: 0.8;">${msg.nickname} Â· ${formatTime(msg.time)}</small><br>${escapeHtml(msg.content)}`;
      } 
      // ç®¡ç†å‘˜å›å¤ï¼šæ˜¾ç¤ºâ€œç®¡ç†å‘˜â€æ ‡è¯†+å†…å®¹ï¼Œé å·¦ï¼Œåº•è‰²ä¸åŒ
      else if (msg.role === "admin") {
        msgDiv.style = "max-width:75%; margin-right:auto; padding:10px 15px; border-radius:12px 12px 12px 0; background:#4CAF50; color:#fff; font-size:14px;";
        msgDiv.innerHTML = `<small style="font-size: 12px; opacity: 0.8;">ç®¡ç†å‘˜ Â· ${formatTime(msg.time)}</small><br>${escapeHtml(msg.content)}`;
      }
      messageContainer.appendChild(msgDiv);
    });

    // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨ï¼ˆæŸ¥çœ‹æœ€æ–°æ¶ˆæ¯ï¼‰
    messageContainer.scrollTop = messageContainer.scrollHeight;
  }

  // ------------------------------
  // åŠŸèƒ½2ï¼šå‘é€æ¶ˆæ¯ï¼ˆå¸¦ç”¨æˆ·æ˜µç§°ï¼ŒåŒæ­¥åˆ°ç¾¤èŠï¼‰
  // ------------------------------
  async function sendUserMessage() {
    const content = userInput.value.trim();
    if (!content) {
      statusTip.textContent = "è¯·è¾“å…¥æ¶ˆæ¯å†…å®¹ï¼";
      return;
    }

    // é˜²æ­¢é‡å¤å‘é€
    if (sendBtn.textContent === "å‘é€ä¸­...") return;
    sendBtn.disabled = true;
    sendBtn.textContent = "å‘é€ä¸­...";
    statusTip.textContent = "";

    try {
      // 1. æœ¬åœ°å…ˆæ·»åŠ å½“å‰ç”¨æˆ·æ¶ˆæ¯ï¼ˆå³æ—¶æ˜¾ç¤ºï¼Œæå‡ä½“éªŒï¼‰
      const userMsg = {
        role: "user",        // æ ‡è¯†ä¸ºæ™®é€šç”¨æˆ·
        nickname: userNickname, // æºå¸¦ç”¨æˆ·æ˜µç§°
        content: content,
        time: new Date().getTime()
      };
      messageList.push(userMsg);
      renderMessages();
      userInput.value = ""; // æ¸…ç©ºè¾“å…¥æ¡†

      // 2. å‘é€åˆ°Telegramï¼ˆè®©ç®¡ç†å‘˜çœ‹åˆ°æ¶ˆæ¯+æ˜µç§°ï¼Œæ–¹ä¾¿å›å¤ï¼‰
      const telegramUrl = `https://api.telegram.org/bot${BOT_CONFIG.botToken}/sendMessage`;
      const formData = new FormData();
      formData.append("chat_id", BOT_CONFIG.adminChatId);
      // æ¶ˆæ¯æ ¼å¼ï¼šã€ç¾¤èŠç”¨æˆ·-æ˜µç§°ã€‘æ—¶é—´ï¼šå†…å®¹ï¼ˆç®¡ç†å‘˜èƒ½æ¸…æ™°åŒºåˆ†æ˜¯è°å‘çš„ï¼‰
      formData.append("text", `ã€ç¾¤èŠç”¨æˆ·-${userNickname}ã€‘\næ—¶é—´ï¼š${formatTime(userMsg.time)}\nå†…å®¹ï¼š${content}`);
      formData.append("parse_mode", "HTML");

      const response = await fetch(telegramUrl, {
        method: "POST",
        body: formData
      });

      const result = await response.json();
      if (!result.ok) throw new Error(result.description || "æ¶ˆæ¯å‘é€å¤±è´¥");

      statusTip.textContent = "æ¶ˆæ¯å‘é€æˆåŠŸï¼æ‰€æœ‰äººå¯è§";
      isWaitingReply = true;
      startRefreshTimer(); // å¯åŠ¨åˆ·æ–°ï¼Œç­‰å¾…ç®¡ç†å‘˜å›å¤

    } catch (err) {
      // å‘é€å¤±è´¥ï¼šç§»é™¤æœ¬åœ°ä¸´æ—¶æ¶ˆæ¯ï¼Œæç¤ºé”™è¯¯
      messageList.pop();
      renderMessages();
      statusTip.textContent = `å‘é€å¤±è´¥ï¼š${err.message}`;
    } finally {
      sendBtn.disabled = false;
      sendBtn.textContent = "å‘é€";
    }
  }

  // ------------------------------
  // åŠŸèƒ½3ï¼šè·å–ç®¡ç†å‘˜å›å¤ï¼ˆåŒæ­¥ç»™æ‰€æœ‰ç¾¤èŠç”¨æˆ·ï¼‰
  // ------------------------------
  async function fetchBotReplies() {
    try {
      const telegramUrl = `https://api.telegram.org/bot${BOT_CONFIG.botToken}/getUpdates?offset=${BOT_CONFIG.updateOffset + 1}&limit=10`;
      const response = await fetch(telegramUrl);
      const result = await response.json();

      if (!result.ok || !result.result.length) return;

      // ç­›é€‰ç®¡ç†å‘˜çš„å›å¤ï¼ˆä»…åŒæ­¥ç®¡ç†å‘˜å‘ç»™ç¾¤èŠçš„å†…å®¹ï¼‰
      const newReplies = [];
      result.result.forEach(update => {
        // æ›´æ–°æœ€æ–°çš„offsetï¼Œé¿å…é‡å¤è·å–å†å²æ¶ˆæ¯
        BOT_CONFIG.updateOffset = Math.max(BOT_CONFIG.updateOffset, update.update_id);
        const msg = update.message;

        // æ¡ä»¶ï¼š1. æ˜¯ç®¡ç†å‘˜å‘é€çš„æ¶ˆæ¯ 2. æ¶ˆæ¯åŒ…å«â€œã€ç¾¤èŠå›å¤ã€‘â€æ ‡è¯†ï¼ˆç®¡ç†å‘˜å›å¤æ—¶éœ€åŠ æ­¤æ ‡è¯†ï¼‰
        if (
          msg?.from?.id === BOT_CONFIG.adminChatId && 
          msg?.text?.includes("ã€ç¾¤èŠå›å¤ã€‘")
        ) {
          // æ„é€ ç®¡ç†å‘˜å›å¤æ¶ˆæ¯ï¼ˆè§’è‰²ä¸ºadminï¼Œæ‰€æœ‰äººå¯è§ï¼‰
          newReplies.push({
            role: "admin",
            content: msg.text.replace("ã€ç¾¤èŠå›å¤ã€‘", "").trim(), // å»æ‰æ ‡è¯†ï¼Œæ˜¾ç¤ºçº¯å›å¤å†…å®¹
            time: msg.date * 1000
          });
        }
      });

      // æœ‰æ–°å›å¤ï¼šæ·»åŠ åˆ°æ¶ˆæ¯åˆ—è¡¨ï¼Œå…¨å‘˜åŒæ­¥æ¸²æŸ“
      if (newReplies.length) {
        messageList.push(...newReplies);
        renderMessages();
        isWaitingReply = false;
        statusTip.textContent = "ç®¡ç†å‘˜å·²å›å¤ï¼Œæ‰€æœ‰äººå¯è§";
      }

    } catch (err) {
      console.error("è·å–å›å¤å¤±è´¥ï¼š", err);
      statusTip.textContent = `åˆ·æ–°å¤±è´¥ï¼š${err.message}ï¼Œå°†ç»§ç»­é‡è¯•...`;
    }
  }

  // ------------------------------
  // å·¥å…·å‡½æ•°ï¼ˆæ—¶é—´æ ¼å¼åŒ–ã€é˜²XSSã€å®šæ—¶å™¨æ§åˆ¶ï¼‰
  // ------------------------------
  function startRefreshTimer() {
    stopRefreshTimer(); // æ¸…é™¤æ—§å®šæ—¶å™¨ï¼Œé¿å…é‡å¤
    fetchBotReplies(); // ç«‹å³åˆ·æ–°ä¸€æ¬¡
    refreshTimer = setInterval(fetchBotReplies, BOT_CONFIG.refreshInterval);
  }

  function stopRefreshTimer() {
    if (refreshTimer) {
      clearInterval(refreshTimer);
      refreshTimer = null;
    }
  }

  function formatTime(timestamp) {
    const d = new Date(timestamp);
    return `${d.getHours().toString().padStart(2,0)}:${d.getMinutes().toString().padStart(2,0)}`;
  }

  function escapeHtml(unsafe) {
    // é˜²XSSæ”»å‡»ï¼Œè¿‡æ»¤ç‰¹æ®Šå­—ç¬¦
    return unsafe
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;")
      .replace(/\n/g, "<br>");
  }

  // ------------------------------
  // äº‹ä»¶ç»‘å®šï¼ˆå‘é€ã€å›è½¦è§¦å‘ã€é¡µé¢åˆå§‹åŒ–ï¼‰
  // ------------------------------
  // ç‚¹å‡»å‘é€æŒ‰é’®
  sendBtn.addEventListener("click", sendUserMessage);
  // å›è½¦å‘é€ï¼ˆShift+Enteræ¢è¡Œï¼‰
  userInput.addEventListener("keydown", (e) => {
    if (e.key === "Enter" && !e.shiftKey) {
      e.preventDefault();
      sendUserMessage();
    }
  });
  // é¡µé¢åŠ è½½æ—¶æ¸²æŸ“æ¶ˆæ¯+å¯åŠ¨åˆ·æ–°
  window.addEventListener("DOMContentLoaded", () => {
    renderMessages();
    startRefreshTimer();
  });
  // é¡µé¢å…³é—­æ—¶æ¸…é™¤å®šæ—¶å™¨
  window.addEventListener("beforeunload", stopRefreshTimer);
</script>


















<!-- æ¨¡å—å¼€å¤´ï¼šGitHubåšå®¢ä¸“ç”¨éŸ³ä¹æ’­æ”¾å™¨ -->
<div style="width: 100%; max-width: 800px; margin: 25px auto; padding: 20px; border-radius: 10px; box-shadow: 0 3px 15px rgba(0,0,0,0.06); background: #ffffff; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
  <!-- éŸ³ä¹é…ç½®åŒºï¼šç›´æ¥æ·»åŠ /ä¿®æ”¹éŸ³ä¹ä¿¡æ¯å³å¯ -->
  <script>
    // ğŸ‘‡ æ ¸å¿ƒé…ç½®ï¼šéŸ³ä¹åˆ—è¡¨ï¼ˆæ”¯æŒå¤šé¦–ï¼Œå¯æ·»åŠ /åˆ é™¤ï¼Œæ¯é¦–éœ€å¡«å†™titleã€artistã€urlï¼‰
    const musicList = [
      {
        title: "å…‰å¹´ä¹‹å¤–",       // éŸ³ä¹æ ‡é¢˜
        artist: "é‚“ç´«æ£‹",     // æ­Œæ‰‹
        url: "https://lu-sycdn.kuwo.cn/be8a87d5df5f5bfb5ecf63eec5ff2522/68d2579f/resource/a2/25/64/2640583885.aac", // éŸ³ä¹æ–‡ä»¶URLï¼ˆéœ€æ˜¯å…¬å¼€å¯è®¿é—®çš„MP3é“¾æ¥ï¼‰
        cover: "https://example.com/covers/gu Yongzhe.jpg" // å¯é€‰ï¼šä¸“è¾‘å°é¢å›¾URL
      },
      {
        title: "èµ·é£äº†",
        artist: "ä¹°è¾£æ¤’ä¹Ÿç”¨åˆ¸",
        url: "https://example.com/music/qi Fengle.mp3",
        cover: "https://example.com/covers/qi Fengle.jpg"
      },
      {
        title: "å°å¹¸è¿",
        artist: "ç”°é¦¥ç”„",
        url: "https://example.com/music/xiao Xingyun.mp3",
        cover: "https://example.com/covers/xiao Xingyun.jpg"
      }
    ];

    // å½“å‰æ’­æ”¾ç´¢å¼•ï¼ˆé»˜è®¤ä»ç¬¬1é¦–å¼€å§‹ï¼‰
    let currentMusicIndex = 0;
  </script>

  <!-- æ’­æ”¾å™¨ä¸»ä½“ -->
  <div style="display: flex; align-items: center; gap: 20px; flex-wrap: wrap;">
    <!-- ä¸“è¾‘å°é¢ -->
    <div style="position: relative; width: 120px; height: 120px; border-radius: 8px; overflow: hidden; flex-shrink: 0;">
      <img id="musicCover" src="" alt="ä¸“è¾‘å°é¢" style="width: 100%; height: 100%; object-fit: cover;">
      <!-- å°é¢æ—‹è½¬åŠ¨ç”»ï¼ˆæ’­æ”¾æ—¶ç”Ÿæ•ˆï¼‰ -->
      <style>
        @keyframes rotate {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
        .rotating { animation: rotate 10s linear infinite; }
      </style>
    </div>

    <!-- éŸ³ä¹ä¿¡æ¯ä¸æ§åˆ¶åŒº -->
    <div style="flex: 1; min-width: 250px;">
      <!-- éŸ³ä¹æ ‡é¢˜ä¸æ­Œæ‰‹ -->
      <h3 id="musicTitle" style="margin: 0 0 8px; font-size: 18px; color: #333;">--</h3>
      <p id="musicArtist" style="margin: 0 0 15px; font-size: 14px; color: #666;">--</p>

      <!-- è¿›åº¦æ¡ -->
      <div style="width: 100%; margin-bottom: 12px;">
        <input 
          id="musicProgress" 
          type="range" 
          min="0" 
          max="100" 
          value="0" 
          style="width: 100%; height: 4px; appearance: none; background: #f2f2f2; border-radius: 2px; outline: none;"
        >
        <!-- è¿›åº¦æ¡æ ·å¼ä¼˜åŒ–ï¼ˆå…¼å®¹ä¸»æµæµè§ˆå™¨ï¼‰ -->
        <style>
          #musicProgress::-webkit-slider-thumb {
            appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #2c3e50;
            cursor: pointer;
          }
          #musicProgress::-moz-range-thumb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #2c3e50;
            cursor: pointer;
            border: none;
          }
        </style>
      </div>

      <!-- æ—¶é—´ä¸æ§åˆ¶æŒ‰é’® -->
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <span id="musicTime" style="font-size: 12px; color: #999;">00:00 / 00:00</span>
        <div style="display: flex; gap: 15px; align-items: center;">
          <button id="prevBtn" style="background: none; border: none; font-size: 20px; color: #2c3e50; cursor: pointer;">â®</button>
          <button id="playPauseBtn" style="background: #2c3e50; color: #fff; border: none; width: 40px; height: 40px; border-radius: 50%; font-size: 18px; cursor: pointer; display: flex; align-items: center; justify-content: center;">â–¶</button>
          <button id="nextBtn" style="background: none; border: none; font-size: 20px; color: #2c3e50; cursor: pointer;">â­</button>
        </div>
      </div>
    </div>
  </div>

  <!-- éŸ³ä¹åˆ—è¡¨ï¼ˆå¯é€‰æ˜¾ç¤ºï¼‰ -->
  <div style="margin-top: 20px; border-top: 1px solid #f5f5f5; padding-top: 15px;">
    <h4 style="margin: 0 0 10px; font-size: 14px; color: #666;">æ’­æ”¾åˆ—è¡¨</h4>
    <ul id="musicPlaylist" style="margin: 0; padding: 0; list-style: none;">
      <!-- åˆ—è¡¨é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
    </ul>
  </div>
</div>

<script>
  // åˆå§‹åŒ–éŸ³é¢‘å…ƒç´ 
  const audio = new Audio();
  // è·å–DOMå…ƒç´ 
  const playPauseBtn = document.getElementById("playPauseBtn");
  const prevBtn = document.getElementById("prevBtn");
  const nextBtn = document.getElementById("nextBtn");
  const musicProgress = document.getElementById("musicProgress");
  const musicTime = document.getElementById("musicTime");
  const musicTitle = document.getElementById("musicTitle");
  const musicArtist = document.getElementById("musicArtist");
  const musicCover = document.getElementById("musicCover");
  const musicPlaylist = document.getElementById("musicPlaylist");
  const coverDom = document.querySelector("#musicCover").parentElement;

  // åŠ è½½æŒ‡å®šç´¢å¼•çš„éŸ³ä¹
  function loadMusic(index) {
    const music = musicList[index];
    audio.src = music.url;
    musicTitle.textContent = music.title;
    musicArtist.textContent = music.artist;
    // åŠ è½½å°é¢ï¼ˆè‹¥æ— åˆ™ç”¨é»˜è®¤å›¾ï¼‰
    musicCover.src = music.cover || "https://via.placeholder.com/120x120?text=Music";
    // æ›´æ–°å½“å‰æ’­æ”¾ç´¢å¼•
    currentMusicIndex = index;
    // æ›´æ–°æ’­æ”¾åˆ—è¡¨é€‰ä¸­çŠ¶æ€
    updatePlaylistActive();
    // åŠ è½½å®Œæˆåè‡ªåŠ¨æ’­æ”¾
    audio.load();
    audio.play().then(() => {
      playPauseBtn.textContent = "â¸";
      coverDom.classList.add("rotating");
    }).catch(err => {
      console.error("æ’­æ”¾å¤±è´¥ï¼š", err);
      playPauseBtn.textContent = "â–¶";
      coverDom.classList.remove("rotating");
    });
  }

  // æ›´æ–°æ’­æ”¾åˆ—è¡¨é€‰ä¸­çŠ¶æ€
  function updatePlaylistActive() {
    const listItems = musicPlaylist.querySelectorAll("li");
    listItems.forEach((item, index) => {
      if (index === currentMusicIndex) {
        item.style.color = "#2c3e50";
        item.style.fontWeight = "500";
      } else {
        item.style.color = "#666";
        item.style.fontWeight = "normal";
      }
    });
  }

  // æ ¼å¼åŒ–æ—¶é—´ï¼ˆç§’è½¬åˆ†:ç§’ï¼‰
  function formatTime(seconds) {
    const min = Math.floor(seconds / 60);
    const sec = Math.floor(seconds % 60);
    return `${min.toString().padStart(2, "0")}:${sec.toString().padStart(2, "0")}`;
  }

  // åˆå§‹åŒ–æ’­æ”¾åˆ—è¡¨
  function initPlaylist() {
    musicList.forEach((music, index) => {
      const li = document.createElement("li");
      li.textContent = `${index + 1}. ${music.title} - ${music.artist}`;
      li.style.padding = "6px 0";
      li.style.cursor = "pointer";
      li.addEventListener("click", () => loadMusic(index));
      musicPlaylist.appendChild(li);
    });
  }

  // äº‹ä»¶ç›‘å¬ï¼šæ’­æ”¾/æš‚åœ
  playPauseBtn.addEventListener("click", () => {
    if (audio.paused) {
      audio.play().then(() => {
        playPauseBtn.textContent = "â¸";
        coverDom.classList.add("rotating");
      }).catch(err => console.error("æ’­æ”¾å¤±è´¥ï¼š", err));
    } else {
      audio.pause();
      playPauseBtn.textContent = "â–¶";
      coverDom.classList.remove("rotating");
    }
  });

  // äº‹ä»¶ç›‘å¬ï¼šä¸Šä¸€é¦–
  prevBtn.addEventListener("click", () => {
    currentMusicIndex = (currentMusicIndex - 1 + musicList.length) % musicList.length;
    loadMusic(currentMusicIndex);
  });

  // äº‹ä»¶ç›‘å¬ï¼šä¸‹ä¸€é¦–
  nextBtn.addEventListener("click", () => {
    currentMusicIndex = (currentMusicIndex + 1) % musicList.length;
    loadMusic(currentMusicIndex);
  });

  // äº‹ä»¶ç›‘å¬ï¼šè¿›åº¦æ¡æ‹–åŠ¨
  musicProgress.addEventListener("input", () => {
    const progress = (musicProgress.value / 100) * audio.duration;
    audio.currentTime = progress;
  });

  // äº‹ä»¶ç›‘å¬ï¼šéŸ³é¢‘è¿›åº¦æ›´æ–°
  audio.addEventListener("timeupdate", () => {
    const progressPercent = (audio.currentTime / audio.duration) * 100;
    musicProgress.value = progressPercent;
    musicTime.textContent = `${formatTime(audio.currentTime)} / ${formatTime(audio.duration)}`;
  });

  // äº‹ä»¶ç›‘å¬ï¼šéŸ³é¢‘æ’­æ”¾ç»“æŸï¼ˆè‡ªåŠ¨ä¸‹ä¸€é¦–ï¼‰
  audio.addEventListener("ended", () => {
    currentMusicIndex = (currentMusicIndex + 1) % musicList.length;
    loadMusic(currentMusicIndex);
  });

  // åˆå§‹åŒ–ï¼šåŠ è½½ç¬¬ä¸€é¦–éŸ³ä¹+ç”Ÿæˆæ’­æ”¾åˆ—è¡¨
  window.addEventListener("DOMContentLoaded", () => {
    initPlaylist();
    loadMusic(0);
  });
</script>
<!-- æ¨¡å—ç»“å°¾ï¼šGitHubåšå®¢ä¸“ç”¨éŸ³ä¹æ’­æ”¾å™¨ -->






	
<!-- æ–‡ç« å†…å®¹ -->
<article>
<h2>YouTubeç›´æ’­</h2>
<p>å‡¤å‡°å«è§†å®æ—¶æ–°é—»ç›´æ’­</p>
<div class="video-container">
  <div id="live-player">åŠ è½½ä¸­...</div>
</div>
</article>

<article>
<h2>ç›´æ’­é¢‘é“</h2>
<!-- ç›´æ’­é¢‘é“å®¹å™¨ -->
<div id="live-channel-feed" style="display:grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;"></div>
</article>

<article>
<h2>éŸ³ä¹åˆ†äº«1</h2>
<p>ä¸€äººä¸€é¦–ç»å…¸æ›²âœŒï¸Ë¶â•¹ê‡´â•¹Ë¶âœŒï¸ </p>
<div class="video-container">
  <iframe width="560" height="315" src="https://www.youtube.com/embed/WbW00ghKFt0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
</article>

<article>
<h2>æ‚ å“‰åšæ–‡</h2>
<p>è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« ï¼Œæ¬¢è¿å¤§å®¶æ¥åˆ°æˆ‘çš„åšå®¢ï¼æˆ‘ä¼šåˆ†äº«ç”Ÿæ´»ã€æŠ€æœ¯ã€æ—…è¡Œå’Œå„ç§æœ‰è¶£çš„å†…å®¹ã€‚</p>
<!-- æ¨ªå‘å±•ç¤ºä¸¤å¼ å›¾ç‰‡ -->
<div class="gallery">
  <img src="https://raw.githubusercontent.com/fuchenyouzai/youzai/main/t2.jpg" alt="å›¾ç‰‡1">
  <img src="https://raw.githubusercontent.com/fuchenyouzai/youzai/main/t4.jpg" alt="å›¾ç‰‡2">
</div>
</article>

<article>
  <h2>æ—…è¡Œè§é—»</h2>
  <p>ç…§ç‰‡å’Œè§†é¢‘åˆ†äº«</p>
  <div class="article-video">
    <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ" title="é»„çŸ³å…¬å›­çŸ­è§†é¢‘" allowfullscreen></iframe>
  </div>
</article>

<article>
  <h2>éŸ³ä¹åˆ†äº«2</h2>
  <p>è¿™æ˜¯æˆ‘æœ€è¿‘å‘ç° çš„ä¸€é¦–éŸ³ä¹ï¼Œå¤§å®¶å¯ä»¥è¯•å¬ã€‚</p>
  <audio controls preload="auto" controlsList="nodownload">
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
  </audio>
</article>

<article>
<h2>æ‚ å“‰ç›¸å†Œ</h2>
<div class="gallery">
<img src="https://raw.githubusercontent.com/fuchenyouzai/youzai/main/t2.jpg" alt="å›¾ç‰‡1">
<img src="https://raw.githubusercontent.com/fuchenyouzai/youzai/main/t4.jpg" alt="å›¾ç‰‡3">
</div>
</article>

<article>
<h2>æ‚ å“‰YouTube</h2>
<a href="https://www.youtube.com/@æ‹‚å°˜æ‚ å“‰" target="_blank" class="telegram-btn">è®¿é—® YouTube</a>
<div id="youtube-feed" style="display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:15px; margin-top:10px;"></div>
</article>

<article>
<h2>æ‚ å“‰ç•™è¨€æ¿1ï¼ˆGitalkï¼‰</h2>
<div id="gitalk-container"></div>
<a href="https://github.com/fuchenyouzai/youzai/issues" target="_blank" class="admin-btn" style="margin-top:10px;">æŸ¥çœ‹ GitHub åå°è¯„è®º</a>
</article>

<article>
<h2>æ‚ å“‰ç•™è¨€æ¿2ï¼ˆDisqus ä¸­æ–‡ï¼‰</h2>
<div id="disqus_thread"></div>
<script>
(function() { 
    var d = document, s = d.createElement('script');
    s.src = 'https://youzaibolg.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
</article>

</main>

<footer>
&copy; 2026 æ‚ å“‰çš„åšå®¢
</footer>
<!-- å®‰è£…æŒ‰é’® -->
<div id="install-btn">
  å®‰è£…æ‚ å“‰åšå®¢åˆ°è®¾å¤‡
</div>

<!-- å³ä¸‹è§’æŒ‰é’® -->
<button id="sound-toggle-btn">ğŸ”Š æ‰“å¼€å£°éŸ³</button>
<button id="mode-toggle-btn">ğŸŒ™ å¤œæ™šæ¨¡å¼</button>

<!-- æ–°å¢ï¼šå·¦ä¸‹è§’å…¨å±€å£°éŸ³æ§åˆ¶æŒ‰é’®ï¼ˆå«éŸ³é‡æ»‘å—ï¼‰ -->
<div id="global-sound-control" style="position: fixed; bottom: 20px; left: 20px; z-index: 1000; display: flex; align-items: center; gap: 10px; background: rgba(0,0,0,0.5); padding: 8px 12px; border-radius: 8px;">
  <!-- å…¨å±€å£°éŸ³å¼€å…³æŒ‰é’® -->
  <button id="global-sound-btn" style="padding: 8px 12px; border: none; border-radius: 6px; background-color: #4CAF50; color: white; font-weight: bold; cursor: pointer; transition: background 0.3s;">ğŸ”Š å…¨å±€æœ‰å£°</button>
  <!-- å…¨å±€éŸ³é‡æ»‘å— -->
  <div style="display: flex; align-items: center; gap: 5px;">
    <span style="color: white; font-size: 14px;">éŸ³é‡</span>
    <input type="range" id="global-volume-slider" min="0" max="100" value="100" style="width: 100px; accent-color: #4CAF50; cursor: pointer;">
  </div>
</div>

<!-- åŸæœ‰ï¼šå³ä¾§éŸ³é‡æ»‘å—åŒºåŸŸ -->
<div style="position: fixed; bottom: 100px; right: 20px; z-index: 1000; display: flex; align-items: center;">
  <span style="color: white; margin-right: 10px; background-color: rgba(0, 0, 0, 0.5); padding: 3px 6px; border-radius: 4px;">éŸ³é‡</span>
  <input type="range" id="volume-slider" min="0" max="100" value="100" style="width: 100px;">
</div>

<!-- å¤–éƒ¨èµ„æºå¼•å…¥ï¼ˆä¿ç•™åŸç»“æ„ï¼‰ -->
<!-- Gitalk -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>

<!-- YouTube IFrame API -->
<script src="https://www.youtube.com/iframe_api"></script>
<script>
// ç›´æ’­é¢‘é“æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªç›´æ’­çš„ ID å’Œæ ‡é¢˜
const liveChannels = [
  {id: "fN9uYWCjQaw", title: "å‡¤å‡°å«è§†æ–°é—»ç›´æ’­"},
  {id: "SdzewdkJa-o", title: "CCTVä¸­æ–‡å›½é™…"},
  {id: "ZB9QSD_SWmM", title: "ç§‘æŠ€æ–°é—»ç›´æ’­"},
  {id: "WbW00ghKFt0", title: "å¨±ä¹ç›´æ’­"}
];

// è·å–ç›´æ’­é¢‘é“å±•ç¤ºå®¹å™¨
const liveChannelFeed = document.getElementById("live-channel-feed");

// åŠ¨æ€ç”Ÿæˆæ¯ä¸ªé¢‘é“çš„ç›´æ’­æ’­æ”¾å™¨
liveChannels.forEach(channel => {
  const channelWrapper = document.createElement("div");
  channelWrapper.style.display = "flex";
  channelWrapper.style.flexDirection = "column";
  channelWrapper.style.gap = "5px";

  // åˆ›å»º iframe å®¹å™¨
  const iframeWrapper = document.createElement("div");
  iframeWrapper.style.position = "relative";
  iframeWrapper.style.width = "100%";
  iframeWrapper.style.height = 0;
  iframeWrapper.style.overflow = "hidden";
  iframeWrapper.style.borderRadius = "5px";
  iframeWrapper.style.paddingBottom = "56.25%"; // 16:9æ¯”ä¾‹
  
  // æ–°å¢ï¼šä¸ºiframeæ·»åŠ enablejsapi=1ï¼Œæ”¯æŒYouTube APIæ§åˆ¶
  iframeWrapper.innerHTML = `<iframe src="https://www.youtube.com/embed/${channel.id}?enablejsapi=1" 
                              style="position:absolute;top:0;left:0;width:100%;height:100%;border:none;"
                              title="${channel.title}" 
                              allowfullscreen
                              id="live-iframe-${channel.id}"></iframe>`;

  // åˆ›å»ºé¢‘é“ä¿¡æ¯
  const channelInfo = document.createElement("div");
  channelInfo.style.display = "flex";
  channelInfo.style.flexDirection = "column";
  channelInfo.style.alignItems = "center";
  channelInfo.style.gap = "5px";

  const titleElement = document.createElement("p");
  titleElement.textContent = channel.title;
  titleElement.style.textAlign = "center";
  titleElement.style.margin = "0";
  titleElement.style.fontWeight = "bold";
  titleElement.style.fontSize = "14px";

  channelInfo.appendChild(titleElement);

  // å°†ç”Ÿæˆçš„ iframe å’Œé¢‘é“ä¿¡æ¯åŠ å…¥é¡µé¢
  channelWrapper.appendChild(iframeWrapper);
  channelWrapper.appendChild(channelInfo);
  liveChannelFeed.appendChild(channelWrapper);

  // æ–°å¢ï¼šç›‘å¬iframeåŠ è½½ï¼Œè·å–æ’­æ”¾å™¨å®ä¾‹å¹¶åŠ å…¥å…¨å±€æ§åˆ¶
  const iframe = document.getElementById(`live-iframe-${channel.id}`);
  iframe.onload = () => {
    setTimeout(() => {
      const player = new YT.Player(`live-iframe-${channel.id}`, {
        events: {
          'onReady': (event) => {
            // åˆå§‹åŒ–å…¨å±€æ’­æ”¾å™¨æ•°ç»„ï¼ˆè‹¥æœªå­˜åœ¨ï¼‰
            if (!window.globalYoutubePlayers) window.globalYoutubePlayers = [];
            // å°†æ’­æ”¾å™¨å®ä¾‹åŠ å…¥å…¨å±€åˆ—è¡¨
            if (!window.globalYoutubePlayers.includes(event.target)) {
              window.globalYoutubePlayers.push(event.target);
            }
            // åŒæ­¥åˆå§‹çŠ¶æ€ï¼ˆé™éŸ³+éŸ³é‡ï¼‰
            event.target.mute();
            const globalSlider = document.getElementById('global-volume-slider');
            if (globalSlider) event.target.setVolume(globalSlider.value);
          }
        }
      });
    }, 500);
  };
});
</script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  // æ–°å¢ï¼š1. æ”¶é›†æ‰€æœ‰ç”»å»Šå›¾ç‰‡ & åˆå§‹åŒ–å½“å‰ç´¢å¼•
  const galleryImages = Array.from(document.querySelectorAll('.gallery img'));
  let currentImageIndex = 0;

  // æ–°å¢ï¼š2. å›¾ç‰‡åˆ‡æ¢æ ¸å¿ƒå‡½æ•°ï¼ˆæ›´æ–°æ”¾å¤§å±‚å›¾ç‰‡ï¼‰
  function updateOverlayImage(index) {
    const overlayImg = document.querySelector('.image-overlay img');
    if (overlayImg && galleryImages[index]) {
      overlayImg.src = galleryImages[index].src;
      overlayImg.alt = galleryImages[index].alt || `å›¾ç‰‡${index + 1}`;
    }
    currentImageIndex = index; // æ›´æ–°å½“å‰ç´¢å¼•
  }

  // æ–°å¢ï¼š3. ä¸Šä¸€å¼ /ä¸‹ä¸€å¼ åˆ‡æ¢å‡½æ•°ï¼ˆæ”¯æŒå¾ªç¯ï¼‰
  function showPrevImage() {
    let newIndex = currentImageIndex - 1;
    newIndex = newIndex < 0 ? galleryImages.length - 1 : newIndex; // å¾ªç¯åˆ°æœ€åä¸€å¼ 
    updateOverlayImage(newIndex);
  }
  function showNextImage() {
    let newIndex = currentImageIndex + 1;
    newIndex = newIndex >= galleryImages.length ? 0 : newIndex; // å¾ªç¯åˆ°ç¬¬ä¸€å¼ 
    updateOverlayImage(newIndex);
  }

  // åŸæœ‰ï¼šå…¨å±€å£°éŸ³æ§åˆ¶åˆå§‹åŒ–ï¼ˆä¿ç•™ï¼‰
  window.globalAudioElements = Array.from(document.querySelectorAll('audio'));
  window.isGlobalSoundOn = false;
  const globalSoundBtn = document.getElementById('global-sound-btn');
  const globalVolumeSlider = document.getElementById('global-volume-slider');

  window.globalAudioElements.forEach(audio => {
    audio.muted = !window.isGlobalSoundOn;
    audio.volume = globalVolumeSlider.value / 100;
  });

  // åŸæœ‰ï¼šGitalk åˆå§‹åŒ–ï¼ˆä¿ç•™ï¼‰
  const gitalk = new Gitalk({
    clientID: 'Ov23lijfU0G3M7jiMFAW',
    clientSecret: '47120dd1810d3a2a9aa0033211f5ee73ef29baa3',
    repo: 'youzai',
    owner: 'fuchenyouzai',
    admin: ['fuchenyouzai'],
    id: location.pathname,
    distractionFreeMode: false,
    language: 'zh-CN'
  });
  gitalk.render('gitalk-container');
  
  // åŸæœ‰ï¼šéŸ³é‡æ»‘å—åŒæ­¥é€»è¾‘ï¼ˆä¿ç•™ï¼‰
  const volumeSlider = document.getElementById('volume-slider');
  volumeSlider.addEventListener('input', (event) => {
    const volume = event.target.value;
    if (window.livePlayer) window.livePlayer.setVolume(volume);
    if (globalVolumeSlider) globalVolumeSlider.value = volume;
    if (window.syncGlobalVolume) window.syncGlobalVolume(volume);
  });

  // é‡å†™ï¼š4. å›¾ç‰‡ç‚¹å‡»æ”¾å¤§é€»è¾‘ï¼ˆæ›¿æ¢åŸé€»è¾‘ï¼Œæ”¯æŒæ»‘åŠ¨+æŒ‰é’®ï¼‰
  galleryImages.forEach((img, index) => {
    img.addEventListener('click', () => {
      currentImageIndex = index; // è®°å½•å½“å‰ç‚¹å‡»å›¾ç‰‡ç´¢å¼•

      // åˆ›å»ºæ”¾å¤§å±‚å®¹å™¨ï¼ˆå¸¦ç±»åæ–¹ä¾¿æ ·å¼æ§åˆ¶ï¼‰
      const overlay = document.createElement('div');
      overlay.className = 'image-overlay';
      overlay.style.position = 'fixed';
      overlay.style.top = 0;
      overlay.style.left = 0;
      overlay.style.width = '100%';
      overlay.style.height = '100%';
      overlay.style.background = 'rgba(0,0,0,0.9)';
      overlay.style.display = 'flex';
      overlay.style.flexDirection = 'column';
      overlay.style.justifyContent = 'center';
      overlay.style.alignItems = 'center';
      overlay.style.cursor = 'default';
      overlay.style.zIndex = '9999';
      overlay.style.padding = '20px';
      overlay.style.boxSizing = 'border-box';

      // æ–°å¢ï¼šä¸Šä¸€å¼ æŒ‰é’®
      const prevBtn = document.createElement('button');
      prevBtn.textContent = 'â† ä¸Šä¸€å¼ ';
      prevBtn.style.position = 'absolute';
      prevBtn.style.left = '20px';
      prevBtn.style.padding = '10px 15px';
      prevBtn.style.backgroundColor = 'rgba(255,255,255,0.2)';
      prevBtn.style.color = 'white';
      prevBtn.style.border = 'none';
      prevBtn.style.borderRadius = '5px';
      prevBtn.style.fontSize = '16px';
      prevBtn.style.cursor = 'pointer';
      prevBtn.style.zIndex = '10';
      prevBtn.style.transition = 'background 0.3s';
      prevBtn.addEventListener('mouseover', () => prevBtn.style.backgroundColor = 'rgba(255,255,255,0.4)');
      prevBtn.addEventListener('click', (e) => {
        e.stopPropagation(); // é˜»æ­¢å…³é—­æ”¾å¤§å±‚
        showPrevImage();
      });

      // æ–°å¢ï¼šä¸‹ä¸€å¼ æŒ‰é’®
      const nextBtn = document.createElement('button');
      nextBtn.textContent = 'ä¸‹ä¸€å¼  â†’';
      nextBtn.style.position = 'absolute';
      nextBtn.style.right = '20px';
      nextBtn.style.padding = '10px 15px';
      nextBtn.style.backgroundColor = 'rgba(255,255,255,0.2)';
      nextBtn.style.color = 'white';
      nextBtn.style.border = 'none';
      nextBtn.style.borderRadius = '5px';
      nextBtn.style.fontSize = '16px';
      nextBtn.style.cursor = 'pointer';
      nextBtn.style.zIndex = '10';
      nextBtn.style.transition = 'background 0.3s';
      nextBtn.addEventListener('mouseover', () => nextBtn.style.backgroundColor = 'rgba(255,255,255,0.4)');
      nextBtn.addEventListener('click', (e) => {
        e.stopPropagation(); // é˜»æ­¢å…³é—­æ”¾å¤§å±‚
        showNextImage();
      });
      // æ–°å¢ï¼šå…³é—­æŒ‰é’®
      const closeBtn = document.createElement('button');
      closeBtn.textContent = 'Ã— å…³é—­';
      closeBtn.style.position = 'absolute';
      closeBtn.style.top = '20px';
      closeBtn.style.padding = '8px 12px';
      closeBtn.style.backgroundColor = 'rgba(255,0,0,0.6)';
      closeBtn.style.color = 'white';
      closeBtn.style.border = 'none';
      closeBtn.style.borderRadius = '5px';
      closeBtn.style.fontSize = '16px';
      closeBtn.style.cursor = 'pointer';
      closeBtn.style.zIndex = '10';
      closeBtn.style.transition = 'background 0.3s';
      closeBtn.addEventListener('mouseover', () => closeBtn.style.backgroundColor = 'rgba(255,0,0,0.8)');
      closeBtn.addEventListener('click', () => {
        document.body.removeChild(overlay);
        document.removeEventListener('keydown', handleKeyDown); // ç§»é™¤é”®ç›˜ç›‘å¬
      });

      // æ”¾å¤§å›¾ç‰‡å…ƒç´ 
      const overlayImg = document.createElement('img');
      overlayImg.src = img.src;
      overlayImg.alt = img.alt || `å›¾ç‰‡${index + 1}`;
      overlayImg.style.maxWidth = '90%';
      overlayImg.style.maxHeight = '80%';
      overlayImg.style.borderRadius = '5px';
      overlayImg.style.objectFit = 'contain'; // ä¿è¯å›¾ç‰‡ä¸æ‹‰ä¼¸

      // ç»„è£…æ”¾å¤§å±‚
      overlay.appendChild(prevBtn);
      overlay.appendChild(nextBtn);
      overlay.appendChild(closeBtn);
      overlay.appendChild(overlayImg);

      // ç‚¹å‡»ç©ºç™½å¤„å…³é—­
      overlay.addEventListener('click', () => {
        document.body.removeChild(overlay);
        document.removeEventListener('keydown', handleKeyDown);
      });

      // æ–°å¢ï¼šç§»åŠ¨ç«¯è§¦æ‘¸æ»‘åŠ¨æ”¯æŒ
      let startX = 0;
      overlay.addEventListener('touchstart', (e) => {
        startX = e.touches[0].clientX; // è®°å½•è§¦æ‘¸èµ·å§‹ä½ç½®
      });
      overlay.addEventListener('touchend', (e) => {
        if (!e.changedTouches[0]) return;
        const endX = e.changedTouches[0].clientX;
        const diffX = endX - startX; // è®¡ç®—æ»‘åŠ¨è·ç¦»
        if (diffX > 50) showPrevImage(); // å³æ»‘â†’ä¸Šä¸€å¼ 
        if (diffX < -50) showNextImage(); // å·¦æ»‘â†’ä¸‹ä¸€å¼ 
      });

      // æ–°å¢ï¼šPCç«¯é”®ç›˜æ–¹å‘é”®æ§åˆ¶
      function handleKeyDown(e) {
        if (e.key === 'ArrowLeft') showPrevImage(); // å·¦ç®­å¤´â†’ä¸Šä¸€å¼ 
        if (e.key === 'ArrowRight') showNextImage(); // å³ç®­å¤´â†’ä¸‹ä¸€å¼ 
        if (e.key === 'Escape') { // ESCé”®â†’å…³é—­
          document.body.removeChild(overlay);
          document.removeEventListener('keydown', handleKeyDown);
        }
      }
      document.addEventListener('keydown', handleKeyDown);

      // åŠ å…¥é¡µé¢
      document.body.appendChild(overlay);
    });
  });

  // åŸæœ‰ï¼šYouTubeè§†é¢‘å¢™é€»è¾‘ï¼ˆä¿ç•™ï¼Œæ— ä¿®æ”¹ï¼‰
  const videos = [
    {id: "ZB9QSD_SWmM", type: "shorts", title: "æœ€æ–° Shorts è§†é¢‘"},
    {id: "SdzewdkJa-o", type: "shorts", title: "CCTVä¸­æ–‡å›½é™…"},
    {id: "ZB9QSD_SWmM", type: "shorts", title: "ç¤ºä¾‹è§†é¢‘ 2"},
    {id: "ZB9QSD_SWmM", type: "video", title: "ç¤ºä¾‹è§†é¢‘ 2"},
    {id: "ZB9QSD_SWmM", type: "video", title: "ç¤ºä¾‹è§†é¢‘ 2"},
    {id: "ZB9QSD_SWmM", type: "video", title: "ç¤ºä¾‹è§†é¢‘ 2"}
  ];
  const feedContainer = document.getElementById("youtube-feed");
  if (feedContainer) {
    videos.forEach((v, index) => {
      const wrapper = document.createElement("div");
      wrapper.style.display = "flex";
      wrapper.style.flexDirection = "column";
      wrapper.style.gap = "5px";

      const iframeWrapper = document.createElement("div");
      iframeWrapper.style.position = "relative";
      iframeWrapper.style.width = "100%";
      iframeWrapper.style.height = 0;
      iframeWrapper.style.overflow = "hidden";
      iframeWrapper.style.borderRadius = "5px";
      iframeWrapper.style.paddingBottom = v.type === "shorts" ? "177.78%" : "56.25%";
      const iframeId = `video-iframe-${index}`;
      iframeWrapper.innerHTML = `<iframe src="https://www.youtube.com/embed/${v.id}?enablejsapi=1" 
              style="position:absolute;top:0;left:0;width:100%;height:100%;border:none;"
              title="${v.title}" 
              allowfullscreen
              id="${iframeId}"></iframe>`;

      const infoDiv = document.createElement("div");
      infoDiv.style.display = "flex";
      infoDiv.style.flexDirection = "column";
      infoDiv.style.alignItems = "center";
      infoDiv.style.gap = "5px";

      const titleEl = document.createElement("p");
      titleEl.textContent = v.title;
      titleEl.style.textAlign = "center";
      titleEl.style.margin = "0";
      titleEl.style.fontWeight = "bold";
      titleEl.style.fontSize = "14px";

      const btn = document.createElement("a");
      btn.href = `https://www.youtube.com/watch?v=${v.id}`;
      btn.target = "_blank";
      btn.textContent = "åœ¨ YouTube ä¸Šè§‚çœ‹";
      btn.style.display = "inline-block";
      btn.style.padding = "5px 10px";
      btn.style.backgroundColor = "#ff0000";
      btn.style.color = "#fff";
      btn.style.borderRadius = "4px";
      btn.style.fontSize = "12px";
      btn.style.textDecoration = "none";

      infoDiv.appendChild(titleEl);
      infoDiv.appendChild(btn);
      wrapper.appendChild(iframeWrapper);
      wrapper.appendChild(infoDiv);
      feedContainer.appendChild(wrapper);

      const videoIframe = document.getElementById(iframeId);
      videoIframe.onload = () => {
        setTimeout(() => {
          const player = new YT.Player(iframeId, {
            events: {
              'onReady': (event) => {
                if (!window.globalYoutubePlayers) window.globalYoutubePlayers = [];
                if (!window.globalYoutubePlayers.includes(event.target)) {
                  window.globalYoutubePlayers.push(event.target);
                }
                event.target.mute();
                if (globalVolumeSlider) event.target.setVolume(globalVolumeSlider.value);
              }
            }
          });
        }, 500);
      };
    });
  }
  // åŸæœ‰ï¼šPWA Service Worker æ³¨å†Œï¼ˆä¿ç•™ï¼‰
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js')
      .then(registration => console.log('Service Worker æ³¨å†ŒæˆåŠŸ:', registration.scope))
      .catch(err => console.log('Service Worker æ³¨å†Œå¤±è´¥:', err));
  }

  // åŸæœ‰ï¼šå…¨å±€éŸ³é‡åŒæ­¥å‡½æ•°ï¼ˆä¿ç•™ï¼‰
  window.syncGlobalVolume = function(volume) {
    if (window.globalAudioElements) {
      window.globalAudioElements.forEach(audio => {
        if (audio) audio.volume = volume / 100;
      });
    }
    if (window.globalYoutubePlayers) {
      window.globalYoutubePlayers.forEach(player => {
        if (player && typeof player.setVolume === 'function') {
          player.setVolume(volume);
        }
      });
    }
    if (window.livePlayer) {
      window.livePlayer.setVolume(volume);
    }
  };

  // åŸæœ‰ï¼šå…¨å±€å£°éŸ³å¼€å…³å‡½æ•°ï¼ˆä¿ç•™ï¼‰
  window.toggleGlobalSound = function() {
    window.isGlobalSoundOn = !window.isGlobalSoundOn;
    if (globalSoundBtn) {
      globalSoundBtn.textContent = window.isGlobalSoundOn ? 'ğŸ”‡ å…¨å±€é™éŸ³' : 'ğŸ”Š å…¨å±€æœ‰å£°';
    }
    if (window.globalAudioElements) {
      window.globalAudioElements.forEach(audio => {
        if (audio) audio.muted = !window.isGlobalSoundOn;
      });
    }
    if (window.globalYoutubePlayers) {
      window.globalYoutubePlayers.forEach(player => {
        if (player && typeof player.mute === 'function' && typeof player.unMute === 'function') {
          window.isGlobalSoundOn ? player.unMute() : player.mute();
        }
      });
    }
    if (window.livePlayer) {
      window.isGlobalSoundOn ? window.livePlayer.unMute() : window.livePlayer.mute();
    }
    const originalSoundBtn = document.getElementById('sound-toggle-btn');
    if (originalSoundBtn) {
      const originalIsOn = originalSoundBtn.textContent.includes('å…³é—­');
      if (originalIsOn !== window.isGlobalSoundOn) {
        originalSoundBtn.click();
      }
    }
  };

  // åŸæœ‰ï¼šPWAå®‰è£…æŒ‰é’®é€»è¾‘ï¼ˆä¿ç•™ï¼‰
  const installBtn = document.getElementById('install-btn');
  let deferredPrompt;
  const isEdge = /Edg/i.test(navigator.userAgent);
  const isChrome = /Chrome/i.test(navigator.userAgent) && !isEdge;

  if (isChrome) {
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
    });
  }

  installBtn.addEventListener('click', async () => {
    if (isChrome) {
      if (!deferredPrompt) { alert("PWA å®‰è£…æ¡ä»¶æœªæ»¡è¶³ï¼Œæˆ–å·²å®‰è£…"); return; }
      deferredPrompt.prompt();
      await deferredPrompt.userChoice;
      deferredPrompt = null;
    } else if (isEdge) {
      alert("è¯·é€šè¿‡æµè§ˆå™¨èœå•é€‰æ‹©â€œç‚¹æ·»åŠ åˆ°æ‰‹æœºæˆ–ç‚¹å®‰è£…æˆ–ç‚¹åˆ›å»ºå¿«æ·æ–¹å¼â€æ¥å®‰è£…åˆ°æ‰‹æœºæˆ–ç”µè„‘æˆ–å¹³æ¿ä¸­ä½¿ç”¨ã€‚");
    } else {
      alert("å½“å‰æµè§ˆå™¨ä¸æ”¯æŒè‡ªåŠ¨å®‰è£…ï¼Œè¯·ä½¿ç”¨ Chrome æˆ– Edge æµè§ˆå™¨ã€‚");
    }
  });

  // åŸæœ‰ï¼šç»‘å®šå…¨å±€æ§åˆ¶æŒ‰é’®äº‹ä»¶ï¼ˆä¿ç•™ï¼‰
  if (globalSoundBtn) {
    globalSoundBtn.addEventListener('click', window.toggleGlobalSound);
  }
  if (globalVolumeSlider) {
    globalVolumeSlider.addEventListener('input', (e) => {
      const volume = e.target.value;
      window.syncGlobalVolume(volume);
    });
  }

}); // DOMContentLoaded ç»“æŸ
</script>
<script>
// åŸæœ‰ï¼šYouTube Player API åˆå§‹åŒ–ç›¸å…³å˜é‡ï¼ˆæ–°å¢å…¨å±€æŒ‚è½½ï¼‰
window.livePlayer;
window.soundOn = false;

// åŸæœ‰ï¼šonYouTubeIframeAPIReadyå‡½æ•°ï¼ˆæ–°å¢ä¸»æ’­æ”¾å™¨åŠ å…¥å…¨å±€æ§åˆ¶ï¼‰
function onYouTubeIframeAPIReady() {
  const latestLiveID = 'fN9uYWCjQaw';
  window.livePlayer = new YT.Player('live-player', {
    videoId: latestLiveID,
    playerVars: { autoplay: 1, mute: 1, controls: 1, modestbranding: 1 },
    events: { 
      'onReady': (event) => { 
        event.target.mute(); 
        // æ–°å¢ï¼šå°†ä¸»ç›´æ’­æ’­æ”¾å™¨åŠ å…¥å…¨å±€åˆ—è¡¨
        if (!window.globalYoutubePlayers) window.globalYoutubePlayers = [];
        if (!window.globalYoutubePlayers.includes(event.target)) {
          window.globalYoutubePlayers.push(event.target);
        }
        // åŒæ­¥å…¨å±€éŸ³é‡
        const globalSlider = document.getElementById('global-volume-slider');
        if (globalSlider) event.target.setVolume(globalSlider.value);
      } 
    }
  });
}

// åŸæœ‰ï¼šå³ä¸‹è§’å£°éŸ³å¼€å…³æŒ‰é’®ï¼ˆä¿ç•™åŸé€»è¾‘ï¼Œä¸å…¨å±€æ§åˆ¶è”åŠ¨ï¼‰
const soundBtn = document.getElementById('sound-toggle-btn');
soundBtn.addEventListener('click', () => {
  if (!window.livePlayer) return;
  window.soundOn = !window.soundOn;
  // æ›´æ–°åŸæœ‰æŒ‰é’®æ–‡å­—
  soundBtn.textContent = window.soundOn ? 'ğŸ”‡ å…³é—­å£°éŸ³' : 'ğŸ”Š æ‰“å¼€å£°éŸ³';
  // åŒæ­¥ä¸»ç›´æ’­æ’­æ”¾å™¨
  window.soundOn ? window.livePlayer.unMute() : window.livePlayer.mute();
  // åŒæ­¥å…¨å±€çŠ¶æ€ä¸å…¶ä»–éŸ³é¢‘/è§†é¢‘
  if (window.isGlobalSoundOn !== window.soundOn) {
    window.isGlobalSoundOn = window.soundOn;
    const globalSoundBtn = document.getElementById('global-sound-btn');
    if (globalSoundBtn) {
      globalSoundBtn.textContent = window.soundOn ? 'ğŸ”‡ å…¨å±€é™éŸ³' : 'ğŸ”Š å…¨å±€æœ‰å£°';
    }
    // åŒæ­¥åŸç”ŸéŸ³é¢‘ä¸å…¶ä»–YouTubeæ’­æ”¾å™¨
    if (window.globalAudioElements) {
      window.globalAudioElements.forEach(audio => {
        if (audio) audio.muted = !window.soundOn;
      });
    }
    if (window.globalYoutubePlayers) {
      window.globalYoutubePlayers.forEach(player => {
        if (player !== window.livePlayer && player && typeof player.mute === 'function' && typeof player.unMute === 'function') {
          window.soundOn ? player.unMute() : player.mute();
        }
      });
    }
  }
});

// åŸæœ‰ï¼šç™½å¤©/å¤œæ™šæ¨¡å¼åˆ‡æ¢æŒ‰é’®ï¼ˆä¿ç•™åŸé€»è¾‘ï¼Œæ— ä¿®æ”¹ï¼‰
const modeBtn = document.getElementById('mode-toggle-btn');
const currentMode = localStorage.getItem('theme') || 'light'; // é»˜è®¤ä½¿ç”¨ 'light' æ¨¡å¼
if (currentMode === 'dark') {
  document.body.classList.add('dark-mode');
  modeBtn.textContent = "â˜€ï¸ ç™½å¤©æ¨¡å¼";
} else {
  document.body.classList.remove('dark-mode');
  modeBtn.textContent = "ğŸŒ™ å¤œæ™šæ¨¡å¼";
}

modeBtn.addEventListener('click', () => {
  document.body.classList.toggle('dark-mode');
  if (document.body.classList.contains('dark-mode')) {
    modeBtn.textContent = "â˜€ï¸ ç™½å¤©æ¨¡å¼";
    localStorage.setItem('theme', 'dark'); // ä¿å­˜å¤œé—´æ¨¡å¼
  } else {
    modeBtn.textContent = "ğŸŒ™ å¤œæ™šæ¨¡å¼";
    localStorage.setItem('theme', 'light'); // ä¿å­˜ç™½å¤©æ¨¡å¼
  }
});
</script>
</body>
</html>
